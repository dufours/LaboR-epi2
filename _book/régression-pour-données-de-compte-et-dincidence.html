<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 8 Régression pour données de compte et d’incidence | Épidémiologie 2 - Labo informatique R (PTM-6675)</title>
  <meta name="description" content="Chapitre 10" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 8 Régression pour données de compte et d’incidence | Épidémiologie 2 - Labo informatique R (PTM-6675)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapitre 10" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 8 Régression pour données de compte et d’incidence | Épidémiologie 2 - Labo informatique R (PTM-6675)" />
  
  <meta name="twitter:description" content="Chapitre 10" />
  

<meta name="author" content="Simon Dufour (Professeur à la Faculté de Médecine vétérinaire de l’Université de Montréal)" />


<meta name="date" content="2023-01-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="régression-logistique.html"/>
<link rel="next" href="analyses-de-survie.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Épidémiologie 2 - Labo informatique R (PTM-6675)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> À propos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#spécificités-de-r"><i class="fa fa-check"></i><b>1.1</b> Spécificités de R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html"><i class="fa fa-check"></i><b>2</b> Bonnes pratiques de gestion de projet</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#organiser-son-projet-de-recherche"><i class="fa fa-check"></i><b>2.1</b> Organiser son projet de recherche</a></li>
<li class="chapter" data-level="2.2" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#où-sauvegarder-son-projet"><i class="fa fa-check"></i><b>2.2</b> Où sauvegarder son projet</a></li>
<li class="chapter" data-level="2.3" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#où-sauvegarder-ses-données"><i class="fa fa-check"></i><b>2.3</b> Où sauvegarder ses données</a></li>
<li class="chapter" data-level="2.4" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#scripts-danalyse"><i class="fa fa-check"></i><b>2.4</b> Scripts d’analyse</a></li>
<li class="chapter" data-level="2.5" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#les-projets-r"><i class="fa fa-check"></i><b>2.5</b> Les projets R</a></li>
<li class="chapter" data-level="2.6" data-path="bonnes-pratiques-de-gestion-de-projet.html"><a href="bonnes-pratiques-de-gestion-de-projet.html#copies-de-sécurité"><i class="fa fa-check"></i><b>2.6</b> Copies de sécurité</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="obtention-des-données-pour-les-travaux-pratiques.html"><a href="obtention-des-données-pour-les-travaux-pratiques.html"><i class="fa fa-check"></i><b>3</b> Obtention des données pour les travaux pratiques</a></li>
<li class="chapter" data-level="4" data-path="aide-de-r.html"><a href="aide-de-r.html"><i class="fa fa-check"></i><b>4</b> Aide de R</a></li>
<li class="chapter" data-level="5" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>5</b> R Markdown</a></li>
<li class="chapter" data-level="6" data-path="régression-linéaire.html"><a href="régression-linéaire.html"><i class="fa fa-check"></i><b>6</b> Régression linéaire</a>
<ul>
<li class="chapter" data-level="6.1" data-path="régression-linéaire.html"><a href="régression-linéaire.html#généralités"><i class="fa fa-check"></i><b>6.1</b> Généralités</a></li>
<li class="chapter" data-level="6.2" data-path="régression-linéaire.html"><a href="régression-linéaire.html#ajouter-des-intervalles-de-confiance"><i class="fa fa-check"></i><b>6.2</b> Ajouter des intervalles de confiance</a></li>
<li class="chapter" data-level="6.3" data-path="régression-linéaire.html"><a href="régression-linéaire.html#test-de-f-pour-comparer-modèles-complet-vs.-réduit"><i class="fa fa-check"></i><b>6.3</b> Test de <em>F</em> pour comparer modèles complet <em>vs.</em> réduit</a></li>
<li class="chapter" data-level="6.4" data-path="régression-linéaire.html"><a href="régression-linéaire.html#transformer-une-variable"><i class="fa fa-check"></i><b>6.4</b> Transformer une variable</a></li>
<li class="chapter" data-level="6.5" data-path="régression-linéaire.html"><a href="régression-linéaire.html#choisir-la-valeur-de-référence-pour-une-variable-catégorique"><i class="fa fa-check"></i><b>6.5</b> Choisir la valeur de référence pour une variable catégorique</a></li>
<li class="chapter" data-level="6.6" data-path="régression-linéaire.html"><a href="régression-linéaire.html#comparer-les-niveaux-dun-prédicteur-catégorique-avec-2-catégories"><i class="fa fa-check"></i><b>6.6</b> Comparer les niveaux d’un prédicteur catégorique avec &gt;2 catégories</a></li>
<li class="chapter" data-level="6.7" data-path="régression-linéaire.html"><a href="régression-linéaire.html#évaluer-une-interaction-entre-2-variables"><i class="fa fa-check"></i><b>6.7</b> Évaluer une interaction entre 2 variables</a></li>
<li class="chapter" data-level="6.8" data-path="régression-linéaire.html"><a href="régression-linéaire.html#tol-et-vif---évaluer-la-colinéarité"><i class="fa fa-check"></i><b>6.8</b> TOL et VIF - Évaluer la colinéarité</a></li>
<li class="chapter" data-level="6.9" data-path="régression-linéaire.html"><a href="régression-linéaire.html#évaluation-du-modèle"><i class="fa fa-check"></i><b>6.9</b> Évaluation du modèle</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="régression-linéaire.html"><a href="régression-linéaire.html#évaluer-la-linéarité-de-la-relation-à-laide-de-courbes-lissées-pour-prédicteur-quantitatif"><i class="fa fa-check"></i><b>6.9.1</b> Évaluer la linéarité de la relation à l’aide de courbes lissées (pour prédicteur quantitatif)</a></li>
<li class="chapter" data-level="6.9.2" data-path="régression-linéaire.html"><a href="régression-linéaire.html#évaluer-la-linéarité-de-la-relation-à-laide-de-termes-polynomiaux-pour-prédicteur-quantitatif"><i class="fa fa-check"></i><b>6.9.2</b> Évaluer la linéarité de la relation à l’aide de termes polynomiaux (pour prédicteur quantitatif)</a></li>
<li class="chapter" data-level="6.9.3" data-path="régression-linéaire.html"><a href="régression-linéaire.html#méthodes-diagnostiques-pour-les-résiduels"><i class="fa fa-check"></i><b>6.9.3</b> Méthodes diagnostiques pour les résiduels</a></li>
<li class="chapter" data-level="6.9.4" data-path="régression-linéaire.html"><a href="régression-linéaire.html#évaluation-des-observations-extrêmes-etou-influentes"><i class="fa fa-check"></i><b>6.9.4</b> Évaluation des observations extrêmes et/ou influentes</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="régression-linéaire.html"><a href="régression-linéaire.html#travaux-pratiques-1---régression-linéaire---base"><i class="fa fa-check"></i><b>6.10</b> Travaux pratiques 1 - Régression linéaire - Base</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="régression-linéaire.html"><a href="régression-linéaire.html#exercices"><i class="fa fa-check"></i><b>6.10.1</b> Exercices</a></li>
<li class="chapter" data-level="6.10.2" data-path="régression-linéaire.html"><a href="régression-linéaire.html#code-r-et-réponses"><i class="fa fa-check"></i><b>6.10.2</b> Code R et réponses</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="régression-linéaire.html"><a href="régression-linéaire.html#travaux-pratiques-2---régression-linéaire---évaluation-du-modèle"><i class="fa fa-check"></i><b>6.11</b> Travaux pratiques 2 - Régression linéaire - Évaluation du modèle</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="régression-linéaire.html"><a href="régression-linéaire.html#exercices-1"><i class="fa fa-check"></i><b>6.11.1</b> Exercices</a></li>
<li class="chapter" data-level="6.11.2" data-path="régression-linéaire.html"><a href="régression-linéaire.html#code-r-et-réponses-1"><i class="fa fa-check"></i><b>6.11.2</b> Code R et réponses</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="régression-linéaire.html"><a href="régression-linéaire.html#travaux-pratiques-3---régression-linéaire---construction-de-modèle"><i class="fa fa-check"></i><b>6.12</b> Travaux pratiques 3 - Régression linéaire - Construction de modèle</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="régression-linéaire.html"><a href="régression-linéaire.html#exercices-2"><i class="fa fa-check"></i><b>6.12.1</b> Exercices</a></li>
<li class="chapter" data-level="6.12.2" data-path="régression-linéaire.html"><a href="régression-linéaire.html#code-r-et-réponses-2"><i class="fa fa-check"></i><b>6.12.2</b> Code R et réponses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="régression-logistique.html"><a href="régression-logistique.html"><i class="fa fa-check"></i><b>7</b> Régression logistique</a>
<ul>
<li class="chapter" data-level="7.1" data-path="régression-logistique.html"><a href="régression-logistique.html#généralités-1"><i class="fa fa-check"></i><b>7.1</b> Généralités</a></li>
<li class="chapter" data-level="7.2" data-path="régression-logistique.html"><a href="régression-logistique.html#effectuer-un-test-de-rapport-de-vraisemblance"><i class="fa fa-check"></i><b>7.2</b> Effectuer un test de rapport de vraisemblance</a></li>
<li class="chapter" data-level="7.3" data-path="régression-logistique.html"><a href="régression-logistique.html#ajouter-des-ic95"><i class="fa fa-check"></i><b>7.3</b> Ajouter des IC95</a></li>
<li class="chapter" data-level="7.4" data-path="régression-logistique.html"><a href="régression-logistique.html#choisir-valeur-de-référence-pour-les-variables-catégoriques"><i class="fa fa-check"></i><b>7.4</b> Choisir valeur de référence pour les variables catégoriques</a></li>
<li class="chapter" data-level="7.5" data-path="régression-logistique.html"><a href="régression-logistique.html#produire-des-tables-de-résultats"><i class="fa fa-check"></i><b>7.5</b> Produire des tables de résultats</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="régression-logistique.html"><a href="régression-logistique.html#présenter-les-rapports-de-cotes-plutôt-que-les-log-odds"><i class="fa fa-check"></i><b>7.5.1</b> Présenter les rapports de cotes plutôt que les log odds</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="régression-logistique.html"><a href="régression-logistique.html#spécifier-pour-quelle-augmentation-dun-prédicteur-continu-le-rapport-de-cotes-est-calculé"><i class="fa fa-check"></i><b>7.6</b> Spécifier pour quelle augmentation d’un prédicteur continu le rapport de cotes est calculé</a></li>
<li class="chapter" data-level="7.7" data-path="régression-logistique.html"><a href="régression-logistique.html#évaluer-une-interaction-entre-2-variables-1"><i class="fa fa-check"></i><b>7.7</b> Évaluer une interaction entre 2 variables</a></li>
<li class="chapter" data-level="7.8" data-path="régression-logistique.html"><a href="régression-logistique.html#comparer-rapports-de-cotes-pour-une-combinaison-spécifique-de-prédicteurs"><i class="fa fa-check"></i><b>7.8</b> Comparer rapports de cotes pour une combinaison spécifique de prédicteurs</a></li>
<li class="chapter" data-level="7.9" data-path="régression-logistique.html"><a href="régression-logistique.html#présenter-leffet-des-prédicteurs-sur-une-échelle-de-probabilité"><i class="fa fa-check"></i><b>7.9</b> Présenter l’effet des prédicteurs sur une échelle de probabilité</a></li>
<li class="chapter" data-level="7.10" data-path="régression-logistique.html"><a href="régression-logistique.html#linéarité-de-la-relation-pour-prédicteur-quantitatif"><i class="fa fa-check"></i><b>7.10</b> Linéarité de la relation (pour prédicteur quantitatif)</a></li>
<li class="chapter" data-level="7.11" data-path="régression-logistique.html"><a href="régression-logistique.html#test-de-fit-de-hosmer-lemeshow-et-de-pearson"><i class="fa fa-check"></i><b>7.11</b> Test de ‘fit’ de Hosmer-Lemeshow et de Pearson</a></li>
<li class="chapter" data-level="7.12" data-path="régression-logistique.html"><a href="régression-logistique.html#évaluation-des-profils-extrêmes-etou-influents"><i class="fa fa-check"></i><b>7.12</b> Évaluation des profils extrêmes et/ou influents</a></li>
<li class="chapter" data-level="7.13" data-path="régression-logistique.html"><a href="régression-logistique.html#sensibilité-spécificité-et-courbe-roc"><i class="fa fa-check"></i><b>7.13</b> Sensibilité, spécificité et courbe ROC</a></li>
<li class="chapter" data-level="7.14" data-path="régression-logistique.html"><a href="régression-logistique.html#travaux-pratiques-4---régression-logistique---base"><i class="fa fa-check"></i><b>7.14</b> Travaux pratiques 4 - Régression logistique - Base</a>
<ul>
<li class="chapter" data-level="7.14.1" data-path="régression-logistique.html"><a href="régression-logistique.html#exercices-3"><i class="fa fa-check"></i><b>7.14.1</b> Exercices</a></li>
<li class="chapter" data-level="7.14.2" data-path="régression-logistique.html"><a href="régression-logistique.html#code-r-et-réponses-3"><i class="fa fa-check"></i><b>7.14.2</b> Code R et réponses</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="régression-logistique.html"><a href="régression-logistique.html#travaux-pratiques-5---régression-logistique---évaluation-du-modèle"><i class="fa fa-check"></i><b>7.15</b> Travaux pratiques 5 - Régression logistique - Évaluation du modèle</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="régression-logistique.html"><a href="régression-logistique.html#exercices-4"><i class="fa fa-check"></i><b>7.15.1</b> Exercices</a></li>
<li class="chapter" data-level="7.15.2" data-path="régression-logistique.html"><a href="régression-logistique.html#code-r-et-réponses-4"><i class="fa fa-check"></i><b>7.15.2</b> Code R et réponses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html"><i class="fa fa-check"></i><b>8</b> Régression pour données de compte et d’incidence</a>
<ul>
<li class="chapter" data-level="8.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#régression-de-poisson"><i class="fa fa-check"></i><b>8.1</b> Régression de Poisson</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#indiquer-un-offset-i.e.-un-dénominateur-par-exemple-un-nombre-danimal-temps-à-risque"><i class="fa fa-check"></i><b>8.1.1</b> Indiquer un “offset” (i.e., un dénominateur, par exemple un nombre d’animal-temps à risque)</a></li>
<li class="chapter" data-level="8.1.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#test-de-rapport-de-vraisemblance"><i class="fa fa-check"></i><b>8.1.2</b> Test de rapport de vraisemblance</a></li>
<li class="chapter" data-level="8.1.3" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#présenter-les-ratios-dincidence"><i class="fa fa-check"></i><b>8.1.3</b> Présenter les ratios d’incidence</a></li>
<li class="chapter" data-level="8.1.4" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#calculer-un-compte-prédit-dévènements"><i class="fa fa-check"></i><b>8.1.4</b> Calculer un compte prédit d’évènements</a></li>
<li class="chapter" data-level="8.1.5" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-niveaux-dun-prédicteur-catégorique-avec-2-catégories-1"><i class="fa fa-check"></i><b>8.1.5</b> Comparer les niveaux d’un prédicteur catégorique avec &gt; 2 catégories</a></li>
<li class="chapter" data-level="8.1.6" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#linéarité-de-la-relation-pour-prédicteur-continu"><i class="fa fa-check"></i><b>8.1.6</b> Linéarité de la relation (pour prédicteur continu)</a></li>
<li class="chapter" data-level="8.1.7" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#test-de-chi-carré-de-pearson"><i class="fa fa-check"></i><b>8.1.7</b> Test de chi-carré de Pearson</a></li>
<li class="chapter" data-level="8.1.8" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#profils-extrêmes-ou-influents"><i class="fa fa-check"></i><b>8.1.8</b> Profils extrêmes ou influents</a></li>
<li class="chapter" data-level="8.1.9" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-comptes-observés-et-prédits"><i class="fa fa-check"></i><b>8.1.9</b> Comparer les comptes observés et prédits</a></li>
<li class="chapter" data-level="8.1.10" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#erreurs-type-mises-à-léchelle-scaled-se"><i class="fa fa-check"></i><b>8.1.10</b> Erreurs-type mises à l’échelle (scaled SE)</a></li>
<li class="chapter" data-level="8.1.11" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#variance-robuste"><i class="fa fa-check"></i><b>8.1.11</b> Variance robuste</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#régression-binomiale-négative"><i class="fa fa-check"></i><b>8.2</b> Régression binomiale négative</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-modèles-poisson-et-binomial-négatif"><i class="fa fa-check"></i><b>8.2.1</b> Comparer les modèles Poisson et Binomial négatif</a></li>
<li class="chapter" data-level="8.2.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#évaluer-les-résiduels-dun-modèle-binomial-négatif"><i class="fa fa-check"></i><b>8.2.2</b> Évaluer les résiduels d’un modèle Binomial négatif</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#modèles-zéro-enflés"><i class="fa fa-check"></i><b>8.3</b> Modèles zéro-enflés</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#généralités-2"><i class="fa fa-check"></i><b>8.3.1</b> Généralités</a></li>
<li class="chapter" data-level="8.3.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#test-de-vuong-comparer-modèle-zéros-enflés-au-modèle-conventionnel"><i class="fa fa-check"></i><b>8.3.2</b> Test de Vuong – Comparer modèle zéros-enflés au modèle conventionnel</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#calcul-du-risque-relatif-à-laide-dune-régression-de-poisson"><i class="fa fa-check"></i><b>8.4</b> Calcul du risque relatif à l’aide d’une régression de Poisson</a></li>
<li class="chapter" data-level="8.5" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#travaux-pratiques-6---régression-de-poisson-et-binomiale-négative"><i class="fa fa-check"></i><b>8.5</b> Travaux pratiques 6 - Régression de Poisson et Binomiale négative</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#exercices-5"><i class="fa fa-check"></i><b>8.5.1</b> Exercices</a></li>
<li class="chapter" data-level="8.5.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#code-r-et-réponses-5"><i class="fa fa-check"></i><b>8.5.2</b> Code R et réponses</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#travaux-pratiques-7---modèles-modifiés-en-zéro-et-calcul-dun-risque-relatif"><i class="fa fa-check"></i><b>8.6</b> Travaux pratiques 7 - Modèles modifiés en zéro et calcul d’un risque relatif</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#exercices-6"><i class="fa fa-check"></i><b>8.6.1</b> Exercices</a></li>
<li class="chapter" data-level="8.6.2" data-path="régression-pour-données-de-compte-et-dincidence.html"><a href="régression-pour-données-de-compte-et-dincidence.html#code-r-et-réponses-6"><i class="fa fa-check"></i><b>8.6.2</b> Code R et réponses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html"><i class="fa fa-check"></i><b>9</b> Analyses de survie</a>
<ul>
<li class="chapter" data-level="9.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#généralités-3"><i class="fa fa-check"></i><b>9.1</b> Généralités</a></li>
<li class="chapter" data-level="9.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#format-des-données-pour-une-analyse-de-survie"><i class="fa fa-check"></i><b>9.2</b> Format des données pour une analyse de survie</a></li>
<li class="chapter" data-level="9.3" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#analyses-non-paramétriques-kaplan-meier"><i class="fa fa-check"></i><b>9.3</b> Analyses non-paramétriques (Kaplan-Meier)</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#table-de-kaplan-meier-et-temps-médian-de-survie"><i class="fa fa-check"></i><b>9.3.1</b> Table de Kaplan-Meier et temps médian de survie</a></li>
<li class="chapter" data-level="9.3.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#courbe-de-survie-de-kaplan-meier"><i class="fa fa-check"></i><b>9.3.2</b> Courbe de survie de Kaplan-Meier</a></li>
<li class="chapter" data-level="9.3.3" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#estimer-la-probabilité-de-survie-pour-un-temps-donné"><i class="fa fa-check"></i><b>9.3.3</b> Estimer la probabilité de survie pour un temps donné</a></li>
<li class="chapter" data-level="9.3.4" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#comparaisons-entre-niveaux-dun-prédicteur-catégorique"><i class="fa fa-check"></i><b>9.3.4</b> Comparaisons entre niveaux d’un prédicteur catégorique</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#régression-de-cox-à-hasard-proportionnel"><i class="fa fa-check"></i><b>9.4</b> Régression de Cox à hasard proportionnel</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#analyses-stratifiées"><i class="fa fa-check"></i><b>9.4.1</b> Analyses stratifiées</a></li>
<li class="chapter" data-level="9.4.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#prédicteur-dont-la-valeur-change-dans-le-temps"><i class="fa fa-check"></i><b>9.4.2</b> Prédicteur dont la valeur change dans le temps</a></li>
<li class="chapter" data-level="9.4.3" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#prédicteur-dont-leffet-change-dans-le-temps"><i class="fa fa-check"></i><b>9.4.3</b> Prédicteur dont l’effet change dans le temps</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#évaluation-du-modèle-1"><i class="fa fa-check"></i><b>9.5</b> Évaluation du modèle</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#linéarité-de-la-relation-pour-les-prédicteurs-quantitatifs"><i class="fa fa-check"></i><b>9.5.1</b> Linéarité de la relation (pour les prédicteurs quantitatifs)</a></li>
<li class="chapter" data-level="9.5.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#valider-la-supposition-de-hasard-proportionnel"><i class="fa fa-check"></i><b>9.5.2</b> Valider la supposition de hasard proportionnel</a></li>
<li class="chapter" data-level="9.5.3" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#évaluer-impact-du-non-respect-de-la-supposition-de-censure-non-informative"><i class="fa fa-check"></i><b>9.5.3</b> Évaluer impact du non-respect de la supposition de censure non-informative</a></li>
<li class="chapter" data-level="9.5.4" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#observations-extrêmes"><i class="fa fa-check"></i><b>9.5.4</b> Observations extrêmes</a></li>
<li class="chapter" data-level="9.5.5" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#observations-influentes"><i class="fa fa-check"></i><b>9.5.5</b> Observations influentes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>9.6</b> Pour aller plus loin</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#erreurs-types-robustes"><i class="fa fa-check"></i><b>9.6.1</b> Erreurs-types robustes</a></li>
<li class="chapter" data-level="9.6.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#régression-de-cox-à-fragilité-partagée"><i class="fa fa-check"></i><b>9.6.2</b> Régression de Cox à fragilité partagée</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#travaux-pratiques-8---analyses-de-survie-non-paramétriques"><i class="fa fa-check"></i><b>9.7</b> Travaux pratiques 8 - Analyses de survie non-paramétriques</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#exercices-7"><i class="fa fa-check"></i><b>9.7.1</b> Exercices</a></li>
<li class="chapter" data-level="9.7.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#code-r-et-réponses-7"><i class="fa fa-check"></i><b>9.7.2</b> Code R et réponses</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#travaux-pratiques-9---analyses-de-survie-semi-paramétriques"><i class="fa fa-check"></i><b>9.8</b> Travaux pratiques 9 - Analyses de survie semi-paramétriques</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#exercices-8"><i class="fa fa-check"></i><b>9.8.1</b> Exercices</a></li>
<li class="chapter" data-level="9.8.2" data-path="analyses-de-survie.html"><a href="analyses-de-survie.html#code-r-et-réponses-8"><i class="fa fa-check"></i><b>9.8.2</b> Code R et réponses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html"><i class="fa fa-check"></i><b>10</b> Modèles mixtes pour données structurées</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#généralités-4"><i class="fa fa-check"></i><b>10.1</b> Généralités</a></li>
<li class="chapter" data-level="10.2" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#évaluer-la-structure-de-regroupement"><i class="fa fa-check"></i><b>10.2</b> Évaluer la structure de regroupement</a></li>
<li class="chapter" data-level="10.3" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#modèle-linéaire-mixte"><i class="fa fa-check"></i><b>10.3</b> Modèle linéaire mixte</a></li>
<li class="chapter" data-level="10.4" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#modèle-mixte-avec-un-seul-intercept-aléatoire"><i class="fa fa-check"></i><b>10.4</b> Modèle mixte avec un seul intercept aléatoire</a></li>
<li class="chapter" data-level="10.5" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#modèle-mixte-avec-plus-dun-intercept-aléatoire"><i class="fa fa-check"></i><b>10.5</b> Modèle mixte avec plus d’un intercept aléatoire</a></li>
<li class="chapter" data-level="10.6" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#partition-de-la-variance"><i class="fa fa-check"></i><b>10.6</b> Partition de la variance</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#coefficient-de-corrélation-intra-classe"><i class="fa fa-check"></i><b>10.6.1</b> Coefficient de corrélation intra-classe</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#effet-contextuel"><i class="fa fa-check"></i><b>10.7</b> Effet contextuel</a></li>
<li class="chapter" data-level="10.8" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#évaluation-du-modèle-2"><i class="fa fa-check"></i><b>10.8</b> Évaluation du modèle</a></li>
<li class="chapter" data-level="10.9" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#pentes-aléatoires"><i class="fa fa-check"></i><b>10.9</b> Pentes aléatoires</a></li>
<li class="chapter" data-level="10.10" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#travaux-pratiques-10---modèles-linéaires-mixtes"><i class="fa fa-check"></i><b>10.10</b> Travaux pratiques 10 - Modèles linéaires mixtes</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#exercices-9"><i class="fa fa-check"></i><b>10.10.1</b> Exercices</a></li>
<li class="chapter" data-level="10.10.2" data-path="modèles-mixtes-pour-données-structurées.html"><a href="modèles-mixtes-pour-données-structurées.html#code-r-et-réponses-9"><i class="fa fa-check"></i><b>10.10.2</b> Code R et réponses</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publié avec bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Épidémiologie 2 - Labo informatique R (PTM-6675)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="régression-pour-données-de-compte-et-dincidence" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapitre 8</span> Régression pour données de compte et d’incidence<a href="régression-pour-données-de-compte-et-dincidence.html#régression-pour-données-de-compte-et-dincidence" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Les régressions pour données de compte et d’incidence (e.g. Poisson, binomiale négative, zero-inflated Poisson (ZIP) et zero-inflated binomiale negative (ZINB)) peuvent être réalisées dans <code>R</code> avec différentes librairies et fonctions.</p>
<p>La figure suivante schématise les différentes méthodes qui pourront être utilisées.</p>
<div class="figure">
<img src="Figures/Fig%20incid.png" alt="" />
<p class="caption">Méthodes de régression pour données de compte et d’incidence.</p>
</div>
<p>Le jeu de données <em>tb_real.csv</em> sera utilisé pour cette section.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous importons ce jeu de données</span></span>
<span id="cb248-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;tb_real.csv&quot;</span>, </span>
<span id="cb248-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb248-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">sep=</span><span class="st">&quot;;&quot;</span></span>
<span id="cb248-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-5" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb248-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb)</span></code></pre></div>
<pre><code>##   obs farm_id type sex age reactors  par
## 1   1    4002    2   0   0        1  525
## 2   2    4002    2   0   1        2 3675
## 3   3    4002    2   0   2        5 5775
## 4   4    4002    2   1   1        3 2625
## 5   5    4002    2   1   2        1  525
## 6   6    4003    2   0   2        2 7824</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous indiquons les variables catégoriques dans le jeu de données. Nous allons aussi ajouter des étiquettes pour faciliter l&#39;interprétation plus tard.</span></span>
<span id="cb250-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-2" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>farm_id <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>farm_id) </span>
<span id="cb250-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-3" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>type, </span>
<span id="cb250-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), </span>
<span id="cb250-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;laitier&quot;</span>,</span>
<span id="cb250-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;boucherie&quot;</span>, </span>
<span id="cb250-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;cervidé&quot;</span>, </span>
<span id="cb250-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;autre&quot;</span>)</span>
<span id="cb250-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-9" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb250-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-10" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>sex, </span>
<span id="cb250-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb250-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;femelle&quot;</span>,</span>
<span id="cb250-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;mâle&quot;</span>)</span>
<span id="cb250-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-14" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb250-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-15" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>age, </span>
<span id="cb250-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>), </span>
<span id="cb250-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0-12 mois&quot;</span>,</span>
<span id="cb250-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-18" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;12-24 mois&quot;</span>,</span>
<span id="cb250-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-19" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;&gt;24 mois&quot;</span>)</span>
<span id="cb250-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb250-20" aria-hidden="true" tabindex="-1"></a>                 )</span></code></pre></div>
<div id="régression-de-poisson" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Régression de Poisson<a href="régression-pour-données-de-compte-et-dincidence.html#régression-de-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La fonction <code>glm()</code> que vous avez déjà utilisée pour la régression logistique pourra effectuer la régression de Poisson lorsque la variable dépendante est simplement un compte d’événements, par exemple un nombre d’animaux positifs à un test de tuberculine dans un groupe d’animaux (i.e. la variable <em>reactors</em> dans le jeu de données <em>tb_real.csv</em>) et qu’il n’y a pas de dénominateur à prendre en considération (i.e., que le nombre d’animal-temps à risque ne varie pas par unité d’étude). Dans ce cas, on n’aura qu’à indiquer la famille (<code>family="poisson"</code>). Notez que la fonction <code>glm()</code> supposera automatiquement que la fonction de lien est le <code>log</code> et que la fonction de la variance est <span class="math inline">\(variance = moyenne\)</span>.</p>
<p>Par exemple, le modèle suivant permettrait d’effectuer une régression de Poisson avec les prédicteurs <em>type</em>, <em>sex</em> et <em>age</em>. D’abord en supposant que ce n’est pas nécessaire de prendre en compte un dénominateur (i.e. un nombre d’animal-temps à risque). Évidemment, cette supposition est incorrecte dans ce cas.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En indiquant family=&quot;poisson&quot;, la fonction glm suppose une distribution de Poisson et un lien log</span></span>
<span id="cb251-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb251-2" aria-hidden="true" tabindex="-1"></a>modele_incid <span class="ot">&lt;-</span> <span class="fu">glm</span>( <span class="at">data=</span>tb,</span>
<span id="cb251-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb251-3" aria-hidden="true" tabindex="-1"></a>                     reactors <span class="sc">~</span> type <span class="sc">+</span> sex <span class="sc">+</span> age, </span>
<span id="cb251-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb251-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb251-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_incid)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactors ~ type + sex + age, family = &quot;poisson&quot;, 
##     data = tb)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.2978  -1.4704  -0.4919  -0.1823   7.0686  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -2.4607     0.7333  -3.356 0.000792 ***
## typeboucherie  -0.4311     0.2359  -1.828 0.067579 .  
## typecervidé     0.3485     0.2237   1.558 0.119226    
## typeautre      -1.4651     0.6113  -2.397 0.016546 *  
## sexmâle        -1.2051     0.1850  -6.513 7.38e-11 ***
## age12-24 mois   3.0549     0.7219   4.232 2.32e-05 ***
## age&gt;24 mois     3.8056     0.7121   5.344 9.10e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 664.82  on 133  degrees of freedom
## Residual deviance: 454.44  on 127  degrees of freedom
## AIC: 597.41
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>L’intercept et le coefficient de chacun des prédicteurs sont rapportés, de même que leur erreur-type, et la valeur de <em>P</em> correspondante.</p>
<div id="indiquer-un-offset-i.e.-un-dénominateur-par-exemple-un-nombre-danimal-temps-à-risque" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Indiquer un “offset” (i.e., un dénominateur, par exemple un nombre d’animal-temps à risque)<a href="régression-pour-données-de-compte-et-dincidence.html#indiquer-un-offset-i.e.-un-dénominateur-par-exemple-un-nombre-danimal-temps-à-risque" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Souvent, un dénominateur (e.g. un nombre d’animal-temps à risque par unité d’étude) doit être pris en compte pour les données d’incidence ou de compte. Par exemple, dans le jeu de données <em>tb_real.csv</em>, la variable <em>par</em> représente le nombre d’animal-jour à risque par groupe et l’on voit que celui-ci varie passablement (de 30 à 118 084 animal-jour à risque). Bien sûr, ce ne serait pas valide de donner le même poids à des groupes avec des dénominateurs passablement différents (e.g. 3 positifs/30 animal-jours à risque est très différent de 3 positifs/118 084 animal-jour à risque). Dans ce cas, on devra indiquer au modèle une variable offset (i.e. un terme qui ne sert qu’à calibrer le poids de chaque observation et pour lequel aucun coefficient de régression n’est calculé). L’option <code>offset()</code> permettra d’indiquer la variable qui servira d’offset. Notez que, puisque la transformation logarithmique est utilisée comme fonction de lien pour la régression de compte et d’incidence, vous devrez d’abord transformer de la même façon (i.e. faire le log naturel) de votre variable qui représentait le nombre d’animal-jour à risque. Cette nouvelle variable représentera le log du nombre d’animal-jour à risque.</p>
<p>Par exemple, le modèle suivant permettrait d’effectuer une régression de Poisson en prenant en compte le dénominateur (i.e. le nombre d’animal-temps à risque ; variable <em>par</em> dans ce cas) de chacun des troupeaux. Ce modèle serait, évidemment, plus approprié dans notre cas.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En premier lieu créons une variable offset qui représentera le nombre d&#39;animaux-jour à risque, mais sur une échelle logarithmique</span></span>
<span id="cb253-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-2" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>log_par<span class="ot">&lt;-</span><span class="fu">log</span>(tb<span class="sc">$</span>par)</span>
<span id="cb253-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous devons indiquer cette variable directement dans le modèle avec + offset()</span></span>
<span id="cb253-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-5" aria-hidden="true" tabindex="-1"></a>modele_incid <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>tb, </span>
<span id="cb253-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-6" aria-hidden="true" tabindex="-1"></a>                    reactors <span class="sc">~</span> type <span class="sc">+</span> sex <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">offset</span>(log_par), </span>
<span id="cb253-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family=</span><span class="st">&quot;poisson&quot;</span></span>
<span id="cb253-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-8" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb253-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb253-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_incid)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactors ~ type + sex + age + offset(log_par), 
##     family = &quot;poisson&quot;, data = tb)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.5386  -0.8607  -0.3364  -0.0429   8.7903  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -11.6899     0.7398 -15.802  &lt; 2e-16 ***
## typeboucherie   0.4422     0.2364   1.871 0.061410 .  
## typecervidé     1.0662     0.2334   4.569 4.91e-06 ***
## typeautre       0.4384     0.6149   0.713 0.475898    
## sexmâle        -0.3619     0.1954  -1.852 0.064020 .  
## age12-24 mois   2.6734     0.7217   3.704 0.000212 ***
## age&gt;24 mois     2.6012     0.7136   3.645 0.000267 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 409.03  on 133  degrees of freedom
## Residual deviance: 348.35  on 127  degrees of freedom
## AIC: 491.32
## 
## Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div id="test-de-rapport-de-vraisemblance" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Test de rapport de vraisemblance<a href="régression-pour-données-de-compte-et-dincidence.html#test-de-rapport-de-vraisemblance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On pourra demander le test de rapport de vraisemblance comme vu en régression logistique.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb255-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(modele_incid) <span class="co">#test du rapport de vraisemblance du modèle</span></span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: reactors ~ type + sex + age + offset(log_par)
## Model 2: reactors ~ 1
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   7 -238.66                         
## 2   1 -396.90 -6 316.47  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Dans ce cas, le modèle est significatif (<em>P</em>&lt; 0.001).</p>
</div>
<div id="présenter-les-ratios-dincidence" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Présenter les ratios d’incidence<a href="régression-pour-données-de-compte-et-dincidence.html#présenter-les-ratios-dincidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En mettant à l’exposant les coefficients de régression, ils représenteront maintenant les ratios d’incidence (RI) lorsqu’un prédicteur continu augmente d’une unité ou pour un niveau d’un prédicteur catégorique comparativement au niveau de référence. Par exemple, on pourrait demander ces coefficients transformés et leur intervalle de confiance.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb257-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons la librairie jtools pour obtenir une table avec les coefficients et les IC95</span></span>
<span id="cb257-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">summ</span>(modele_incid, </span>
<span id="cb257-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">confint =</span> <span class="cn">TRUE</span></span>
<span id="cb257-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-5" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb257-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons round() pour ajuster la précision des valeurs dans les tables</span></span>
<span id="cb257-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(j<span class="sc">$</span>coeftable), </span>
<span id="cb257-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits=</span><span class="dv">2</span></span>
<span id="cb257-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb257-9" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div>
<pre><code>##                Est. 2.5% 97.5% z val.    p
## (Intercept)    0.00 0.00  0.00   0.00 1.00
## typeboucherie  1.56 0.98  2.47   6.49 1.06
## typecervidé    2.90 1.84  4.59  96.42 1.00
## typeautre      1.55 0.46  5.17   2.04 1.61
## sexmâle        0.70 0.47  1.02   0.16 1.07
## age12-24 mois 14.49 3.52 59.62  40.61 1.00
## age&gt;24 mois   13.48 3.33 54.59  38.28 1.00</code></pre>
<p>Par exemple, le RI de <em>boucherie</em> comparativement à la valeur de référence <em>laitier</em> est de 1.56 (IC95: 0.98, 2.47).</p>
</div>
<div id="calculer-un-compte-prédit-dévènements" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Calculer un compte prédit d’évènements<a href="régression-pour-données-de-compte-et-dincidence.html#calculer-un-compte-prédit-dévènements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On pourra également demander le compte attendu d’évènements pour un individu avec un profil de prédicteurs donné. Il faudrait alors simplement additionner manuellement l’intercept, puis les niveaux des prédicteurs qui nous intéressent et, ensuite, mettre cette somme à l’exposant. Plus pratiquement, on pourra demander dans <code>R</code> une prédiction pour une combinaison donnée. Par exemple, dans le code qui suit nous génèrons un petit jeu de données qui contiendra les valeurs des prédicteurs pour lesquelles nous voudrons obtenir le compte prédit d’évènements. Par exemple, troupeau laitier (<em>type</em>=1), femelle (<em>sex</em>=0) et 0-12 mois d’âge (<em>age</em>=0). Nous avons aussi indiqué que la variable <em>log_par</em> (l’offset) prendrait la valeur log(100 000). On aura donc un compte d’évènements pour 100 000 animaux-jours à risque.</p>
<p>Puis, nous demandons simplement la prédiction à l’aide de la fonction <code>predict()</code>. Nous y indiquons l’objet modèle qui a préalablement été créé (<em>modele_incid</em>) et le petit jeu de données qui contient les valeurs que nous venons de créer (<em>new.tb</em>). Il ne reste qu’à mettre le tout à l’exposant avec la fonction <code>exp()</code>.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous générons le jeu de données avec les valeurs pour lesquelles nous voudrons obtenir le compte prédit d&#39;évènements.</span></span>
<span id="cb259-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-2" aria-hidden="true" tabindex="-1"></a>new.tb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type=</span><span class="st">&quot;laitier&quot;</span>, </span>
<span id="cb259-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sex=</span><span class="st">&quot;femelle&quot;</span>, </span>
<span id="cb259-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">age=</span><span class="st">&quot;0-12 mois&quot;</span>, </span>
<span id="cb259-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">log_par=</span>(<span class="fu">log</span>(<span class="dv">100000</span>)</span>
<span id="cb259-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-6" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb259-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-7" aria-hidden="true" tabindex="-1"></a>                     ) </span>
<span id="cb259-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous générons la prédiction pour cette combinaison de prédicteurs.</span></span>
<span id="cb259-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-10" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">predict</span>(modele_incid, </span>
<span id="cb259-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">newdata=</span>new.tb</span>
<span id="cb259-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb259-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb259-13" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>##         1 
## 0.8378225</code></pre>
<p>Le modèle prédit donc 0.84 cas de TB par 100 000 animaux-jours à risque chez les troupeaux de femelles laitières de 0-12 mois.</p>
</div>
<div id="comparer-les-niveaux-dun-prédicteur-catégorique-avec-2-catégories-1" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Comparer les niveaux d’un prédicteur catégorique avec &gt; 2 catégories<a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-niveaux-dun-prédicteur-catégorique-avec-2-catégories-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comme pour la régression logistique, les fonctions <code>emmeans()</code> et <code>pairs()</code> du package <code>emmeans</code> vous permettent de comparer toutes les combinaisons possibles d’un ou plusieurs prédicteurs catégoriques et/ou quantitatifs.</p>
<p>Par exemple, le code suivant permet de comparer les catégories de la variable <em>type</em> entre elles. Notez qu’en indiquant <code>type="response"</code>, les résultats seront présentés sous forme de ratio d’incidence (RI). Ils sont aussi déjà ajustés pour les comparaisons multiples avec l’ajustement de Tukey-Kramer.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb261-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-2" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modele_incid, </span>
<span id="cb261-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>)</span>
<span id="cb261-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-4" aria-hidden="true" tabindex="-1"></a>                    ) </span>
<span id="cb261-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">pairs</span>(contrast, </span>
<span id="cb261-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb261-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb261-7" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<pre><code>##  contrast            ratio     SE  df asymp.LCL asymp.UCL
##  laitier / boucherie 0.643 0.1519 Inf     0.350     1.180
##  laitier / cervidé   0.344 0.0804 Inf     0.189     0.627
##  laitier / autre     0.645 0.3967 Inf     0.133     3.131
##  boucherie / cervidé 0.536 0.0888 Inf     0.350     0.820
##  boucherie / autre   1.004 0.5958 Inf     0.219     4.612
##  cervidé / autre     1.874 1.1002 Inf     0.414     8.469
## 
## Results are averaged over the levels of: sex, age 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 4 estimates 
## Intervals are back-transformed from the log scale</code></pre>
<p>On note, par exemple, que les laitiers ont une incidence 0.64 fois plus faible (IC95: 0.35, 1.18) que les boucheries. Si vous voulez voir les comparaisons dans l’autre sens (boucherie comparé à laitier, plutôt que laitier comparé à boucherie), vous pouvez ajouter l’option <code>reverse=TRUE</code> dans la fonction <code>pairs()</code>.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb263-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-2" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modele_incid, </span>
<span id="cb263-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>)</span>
<span id="cb263-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-4" aria-hidden="true" tabindex="-1"></a>                    ) </span>
<span id="cb263-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">pairs</span>(contrast, </span>
<span id="cb263-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">reverse=</span><span class="cn">TRUE</span>, </span>
<span id="cb263-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb263-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb263-8" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<pre><code>##  contrast            ratio    SE  df asymp.LCL asymp.UCL
##  boucherie / laitier 1.556 0.368 Inf     0.848      2.86
##  cervidé / laitier   2.904 0.678 Inf     1.595      5.29
##  cervidé / boucherie 1.866 0.309 Inf     1.219      2.86
##  autre / laitier     1.550 0.953 Inf     0.319      7.52
##  autre / boucherie   0.996 0.591 Inf     0.217      4.58
##  autre / cervidé     0.534 0.313 Inf     0.118      2.41
## 
## Results are averaged over the levels of: sex, age 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 4 estimates 
## Intervals are back-transformed from the log scale</code></pre>
</div>
<div id="linéarité-de-la-relation-pour-prédicteur-continu" class="section level3 hasAnchor" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> Linéarité de la relation (pour prédicteur continu)<a href="régression-pour-données-de-compte-et-dincidence.html#linéarité-de-la-relation-pour-prédicteur-continu" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La linéarité de la relation est une supposition importante du modèle. Pour les prédicteurs continus, vous devrez toujours vérifier si cette supposition est bien respectée. Vous pouvez le faire simplement à l’aide du modèle polynomial, comme vu précédemment (en ajoutant le <span class="math inline">\(prédicteur^2\)</span> ou le <span class="math inline">\(prédicteur^2\)</span> et le <span class="math inline">\(prédicteur^3\)</span> dans votre modèle).</p>
</div>
<div id="test-de-chi-carré-de-pearson" class="section level3 hasAnchor" number="8.1.7">
<h3><span class="header-section-number">8.1.7</span> Test de chi-carré de Pearson<a href="régression-pour-données-de-compte-et-dincidence.html#test-de-chi-carré-de-pearson" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous pouvons calculer la somme des résiduels de <span class="math inline">\(Pearson^2\)</span> de la façon suivante:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb265-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-2" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> <span class="fu">augment</span>(modele_incid, </span>
<span id="cb265-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">type.residuals =</span> <span class="st">&quot;pearson&quot;</span>) <span class="co">#Nous venons de créer une nouvelle table avec les résiduels, etc. </span></span>
<span id="cb265-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous calculons la somme de ces résiduels au carré. Dans ce cas: 1105.7</span></span>
<span id="cb265-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span>(diag<span class="sc">$</span>.resid<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb265-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb265-7" aria-hidden="true" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>## [1] 1105.703</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous vérifions à quelle probabilité la valeur 1105.7 correspond dans une distribution de chi-carré avec les degrés de liberté (n - le nombre de coefficients-1).</span></span>
<span id="cb267-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb267-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(s, </span>
<span id="cb267-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb267-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">df=</span>(<span class="dv">134-6-1</span>) </span>
<span id="cb267-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb267-4" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb267-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb267-5" aria-hidden="true" tabindex="-1"></a>P</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous pouvons aussi calculer le paramètre de dispersion</span></span>
<span id="cb269-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb269-2" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> s<span class="sc">/</span>(<span class="dv">134-6-1</span>)</span>
<span id="cb269-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb269-3" aria-hidden="true" tabindex="-1"></a>disp</span></code></pre></div>
<pre><code>## [1] 8.70632</code></pre>
<p>Dans ce cas la valeur de <em>P</em> est très petite (i.e. <em>P</em> est près de 0), le test de <span class="math inline">\(X^2\)</span> de Pearson nous permet donc de conclure que le modèle n’est pas adéquat pour ces données. Il s’agit probablement d’un problème de surdispersion puisque la somme des résiduels de Pearson divisée par les ddl est égale à 8.7 (ce qui est beaucoup plus grand que 1.25). La variance est donc &gt; que la moyenne dans ce jeu de données.</p>
</div>
<div id="profils-extrêmes-ou-influents" class="section level3 hasAnchor" number="8.1.8">
<h3><span class="header-section-number">8.1.8</span> Profils extrêmes ou influents<a href="régression-pour-données-de-compte-et-dincidence.html#profils-extrêmes-ou-influents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comme pour la régression logistique, vous pouvez demander de créer une nouvelle table contenant, en plus de vos variables originales, les différentes valeurs (e.g. résiduels de Pearson, de Déviance, probabilité prédite, leviers) qui serviront à évaluer votre modèle. La fonction <code>augment()</code> du package <code>broom</code> vous permet de le faire. Vous pourrez ensuite trier cette table pour identifier, par exemple, les observations avec les résiduels, leviers ou distance de Cook les plus extrêmes et essayer de comprendre si ces observations ont quelque chose en commun.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb271-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb271-2" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> <span class="fu">augment</span>(modele_incid) <span class="co">#Nous venons de créer une nouvelle table dans laquelle les résiduels, distance de cook, etc se trouvent maintenant</span></span>
<span id="cb271-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diag)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   reactors type      sex     age   offse…¹ .fitted .resid .std.…²    .hat .sigma
##      &lt;int&gt; &lt;fct&gt;     &lt;fct&gt;   &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1        1 boucherie femelle 0-12…    6.26 -4.98    2.83    2.83  0.00352   1.64
## 2        2 boucherie femelle 12-2…    8.21 -0.365   1.27    1.29  0.0247    1.66
## 3        5 boucherie femelle &gt;24 …    8.66  0.0148  2.82    2.85  0.0168    1.64
## 4        3 boucherie mâle    12-2…    7.87 -1.06    2.77    2.80  0.0217    1.64
## 5        1 boucherie mâle    &gt;24 …    6.26 -2.74    1.90    1.91  0.00324   1.65
## 6        2 boucherie femelle &gt;24 …    8.96  0.318   0.499   0.505 0.0228    1.66
## # … with 1 more variable: .cooksd &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`offset(log_par)`, ²​.std.resid</code></pre>
<p>Notez que les valeurs prédites sont sur une échelle de log(compte). Les valeurs prédites sur une échelle de compte par 1 animal-jour à risque ont cependant été conservées dans votre objet modèle. Vous pouvez donc simplement les ajouter à votre table de diagnostic, si vous le désirez. Vous pourriez aussi les multiplier par 100 000 pour avoir un taux par 100 000 animaux-jour (ou par 100 et par 365 pour un taux par 100 animaux-année).</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb273-1" aria-hidden="true" tabindex="-1"></a>diag<span class="sc">$</span>pred_count <span class="ot">&lt;-</span> modele_incid<span class="sc">$</span>fitted.values</span>
<span id="cb273-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diag)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   reactors type      sex     age   offse…¹ .fitted .resid .std.…²    .hat .sigma
##      &lt;int&gt; &lt;fct&gt;     &lt;fct&gt;   &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1        1 boucherie femelle 0-12…    6.26 -4.98    2.83    2.83  0.00352   1.64
## 2        2 boucherie femelle 12-2…    8.21 -0.365   1.27    1.29  0.0247    1.66
## 3        5 boucherie femelle &gt;24 …    8.66  0.0148  2.82    2.85  0.0168    1.64
## 4        3 boucherie mâle    12-2…    7.87 -1.06    2.77    2.80  0.0217    1.64
## 5        1 boucherie mâle    &gt;24 …    6.26 -2.74    1.90    1.91  0.00324   1.65
## 6        2 boucherie femelle &gt;24 …    8.96  0.318   0.499   0.505 0.0228    1.66
## # … with 2 more variables: .cooksd &lt;dbl&gt;, pred_count &lt;dbl&gt;, and abbreviated
## #   variable names ¹​`offset(log_par)`, ²​.std.resid</code></pre>
<p>À partir de cette table, vous pourriez produire les graphiques qui vous intéresseront à l’aide de la fonction <code>ggplot()</code> ou simplement classer la table pour voir les résiduels les plus grands, comme nous l’avons déjà fait précédemment.</p>
</div>
<div id="comparer-les-comptes-observés-et-prédits" class="section level3 hasAnchor" number="8.1.9">
<h3><span class="header-section-number">8.1.9</span> Comparer les comptes observés et prédits<a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-comptes-observés-et-prédits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vous pourrez représenter graphiquement les comptes observés <em>vs.</em> prédits de la manière suivante, en utilisant les résultats de votre modèle et la fonction <code>ggplot()</code> de la libraire <code>ggplot2</code>. Dans votre objet “modèle”, la variable <em>y</em> représente le compte observé d’évènements et la variable <em>fitted.values</em> représente le compte prédit d’évènements. Vous pouvez les mettre ensemble dans une même base de données et ensuite produire des histogrammes pour chacune de ces valeurs ou encore, comme à la figure 18.2 du livre <strong>VER</strong>, un polygone de fréquence.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En premier, nous réunissons les valeurs observées et prédites dans un même jeu de données.</span></span>
<span id="cb275-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-2" aria-hidden="true" tabindex="-1"></a>obs_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">obs=</span>modele_incid<span class="sc">$</span>y, </span>
<span id="cb275-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pred=</span>modele_incid<span class="sc">$</span>fitted.values)</span>
<span id="cb275-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-4" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb275-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensuite nous générons les deux polygones de fréquence dans une même figure.</span></span>
<span id="cb275-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb275-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>obs_pred, </span>
<span id="cb275-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>obs)</span>
<span id="cb275-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-10" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb275-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="co">#Nous demandons d&#39;abord une ligne pour les valeurs observées</span></span>
<span id="cb275-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co">#Nous demandons à ne pas avoir de légende dans ce cas</span></span>
<span id="cb275-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pred, </span>
<span id="cb275-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb275-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-15" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> <span class="co">#Nous demandons ensuite une ligne pour les valeurs prédites</span></span>
<span id="cb275-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, </span>
<span id="cb275-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-17" aria-hidden="true" tabindex="-1"></a>       <span class="cn">NA</span>) <span class="sc">+</span> <span class="co">#Nous limitons l&#39;axe à zéro</span></span>
<span id="cb275-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb275-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co">#Un thème blanc</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-80"></span>
<img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-80-1.png" alt="Comparaison des comptes d'animaux réactifs observés (bleu) et prédits (rouge)." width="672" />
<p class="caption">
Figure 8.1: Comparaison des comptes d’animaux réactifs observés (bleu) et prédits (rouge).
</p>
</div>
<p>Dans ce cas, on note un certain écart entre les comptes observés et prédits dans les troupeaux avec 0 animal positif (près de 87 troupeaux avaient 0 animal positif alors que le modèle prédit moins de troupeaux avec des comptes s’approchant de 0). Pour les autres valeurs, le modèle prédit des valeurs assez près des valeurs observées, mais est incapable de prédire des valeurs très élevées (e.g., 29 cas dans un troupeau).</p>
</div>
<div id="erreurs-type-mises-à-léchelle-scaled-se" class="section level3 hasAnchor" number="8.1.10">
<h3><span class="header-section-number">8.1.10</span> Erreurs-type mises à l’échelle (scaled SE)<a href="régression-pour-données-de-compte-et-dincidence.html#erreurs-type-mises-à-léchelle-scaled-se" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une solution à la sur-dispersion est d’utiliser des erreurs-types mises à l’échelle (i.e. scaled SE). En fait, les erreurs-type sont alors simplement multipliées par la racine carrée du paramètre de dispersion de Pearson. Ce paramètre étant simplement la somme des résiduels de Pearson divisé par les degrés de liberté. En spécifiant <code>family="quasipoisson"</code> ce sera alors les erreurs-types mises à l’échelle qui vous seront présentées et qui serviront à calculer les IC95.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb276-1" aria-hidden="true" tabindex="-1"></a>modele_scaled <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>tb, </span>
<span id="cb276-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb276-2" aria-hidden="true" tabindex="-1"></a>                     reactors <span class="sc">~</span> type <span class="sc">+</span> sex <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">offset</span>(log_par), </span>
<span id="cb276-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb276-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">&quot;quasipoisson&quot;</span></span>
<span id="cb276-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb276-4" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb276-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_scaled)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactors ~ type + sex + age + offset(log_par), 
##     family = &quot;quasipoisson&quot;, data = tb)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.5386  -0.8607  -0.3364  -0.0429   8.7903  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -11.6899     2.1828  -5.355 3.87e-07 ***
## typeboucherie   0.4422     0.6976   0.634    0.527    
## typecervidé     1.0662     0.6886   1.548    0.124    
## typeautre       0.4384     1.8144   0.242    0.809    
## sexmâle        -0.3619     0.5765  -0.628    0.531    
## age12-24 mois   2.6734     2.1296   1.255    0.212    
## age&gt;24 mois     2.6012     2.1057   1.235    0.219    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 8.706329)
## 
##     Null deviance: 409.03  on 133  degrees of freedom
## Residual deviance: 348.35  on 127  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>On note que les erreurs-types sont 2.9 fois plus grandes que ce qu’elles étaient avant. Notre facteur de dispersion était justement 8.7 et la racine carré de 8.7 est 2.9.</p>
</div>
<div id="variance-robuste" class="section level3 hasAnchor" number="8.1.11">
<h3><span class="header-section-number">8.1.11</span> Variance robuste<a href="régression-pour-données-de-compte-et-dincidence.html#variance-robuste" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les erreurs-types robustes peuvent aussi être utilisées lorsqu’il y a problème de sur-dispersion (ou de nombreux autres problèmes comme la dépendance des données). La fonction <code>sandwich()</code> de la librairie <code>sandwich</code> permet de calculer la variance robuste pour le modèle, nous obtiendrons alors les erreurs-types robustes avec la racine carrée de ces variances.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb278-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous demandons la variance robuste</span></span>
<span id="cb278-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-3" aria-hidden="true" tabindex="-1"></a>rob_var<span class="ot">&lt;-</span><span class="fu">sandwich</span>(modele_incid) </span>
<span id="cb278-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Les valeurs qui nous intéressent sont sur la diagonale, la fonction diag nous permet de les isoler</span></span>
<span id="cb278-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-5" aria-hidden="true" tabindex="-1"></a>rob_var<span class="ot">&lt;-</span><span class="fu">diag</span>(rob_var)</span>
<span id="cb278-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Et maintenant nous appliquons la racine carrée</span></span>
<span id="cb278-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-7" aria-hidden="true" tabindex="-1"></a>rob_SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rob_var)</span>
<span id="cb278-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Vous auriez aussi pu faire:</span></span>
<span id="cb278-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">#rob_SE &lt;-sqrt(diag(sandwich(modele_incid)))</span></span>
<span id="cb278-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Pour faciliter la lecture, nous pourrions ajouter ces erreurs-types robustes à nos coefficients dans une même table</span></span>
<span id="cb278-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-13" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">Estimate=</span>modele_incid<span class="sc">$</span>coefficients, </span>
<span id="cb278-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">robust_SE=</span>rob_SE)</span>
<span id="cb278-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-15" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb278-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb278-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb278-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(tab_SE, </span>
<span id="cb278-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits=</span><span class="dv">3</span>), </span>
<span id="cb278-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;Modèle de Poisson avec erreurs-types robustes.&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb278-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb278-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-82">Table 8.1: </span>Modèle de Poisson avec erreurs-types robustes.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
robust_SE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-11.690
</td>
<td style="text-align:right;">
0.913
</td>
</tr>
<tr>
<td style="text-align:left;">
typeboucherie
</td>
<td style="text-align:right;">
0.442
</td>
<td style="text-align:right;">
0.456
</td>
</tr>
<tr>
<td style="text-align:left;">
typecervidé
</td>
<td style="text-align:right;">
1.066
</td>
<td style="text-align:right;">
0.496
</td>
</tr>
<tr>
<td style="text-align:left;">
typeautre
</td>
<td style="text-align:right;">
0.438
</td>
<td style="text-align:right;">
0.764
</td>
</tr>
<tr>
<td style="text-align:left;">
sexmâle
</td>
<td style="text-align:right;">
-0.362
</td>
<td style="text-align:right;">
0.432
</td>
</tr>
<tr>
<td style="text-align:left;">
age12-24 mois
</td>
<td style="text-align:right;">
2.673
</td>
<td style="text-align:right;">
0.858
</td>
</tr>
<tr>
<td style="text-align:left;">
age&gt;24 mois
</td>
<td style="text-align:right;">
2.601
</td>
<td style="text-align:right;">
0.854
</td>
</tr>
</tbody>
</table>
<p>Notez que, si vous désirez utiliser des erreurs-types robustes <strong>ET</strong> les intégrer dans un ajustement pour comparaisons multiples, c’est un peu plus compliqué. Vous devrez combiner la librairie <code>multcomp</code> et la librairie <code>sandwich</code>. Nous utilisons la fonction <code>glht()</code> de cette première librairie pour obtenir des comparaisons multiples et l’option <code>vcov=sandwich</code>pour utiliser la variance robuste.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb279-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb279-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Ici nous demandons une comparaison multiple avec ajustement de Tukey et les erreur-types robustes</span></span>
<span id="cb279-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-4" aria-hidden="true" tabindex="-1"></a>tukey <span class="ot">&lt;-</span> <span class="fu">glht</span>(modele_incid, </span>
<span id="cb279-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">type=</span><span class="st">&quot;Tukey&quot;</span>, </span>
<span id="cb279-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">age=</span><span class="st">&quot;Tukey&quot;</span>, </span>
<span id="cb279-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sex=</span><span class="st">&quot;Tukey&quot;</span>), </span>
<span id="cb279-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">vcov =</span> sandwich)</span>
<span id="cb279-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous ajoutons les IC95</span></span>
<span id="cb279-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-11" aria-hidden="true" tabindex="-1"></a>with_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(tukey)</span>
<span id="cb279-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous les transformons en IR</span></span>
<span id="cb279-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-14" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="ot">&lt;-</span> <span class="fu">exp</span>(with_ci<span class="sc">$</span>confint)</span>
<span id="cb279-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous présentons la table en arrondissant les IR à 2 décimales.</span></span>
<span id="cb279-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb279-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb279-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(tukey_results, </span>
<span id="cb279-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb279-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;IR du modèle de Poisson avec erreur-types robustes et IC95 ajustées pour comparaisons multiples.&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb279-22"><a href="régression-pour-données-de-compte-et-dincidence.html#cb279-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-83">Table 8.2: </span>IR du modèle de Poisson avec erreur-types robustes et IC95 ajustées pour comparaisons multiples.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
type: boucherie - laitier
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
5.40
</td>
</tr>
<tr>
<td style="text-align:left;">
type: cervidé - laitier
</td>
<td style="text-align:right;">
2.90
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
11.27
</td>
</tr>
<tr>
<td style="text-align:left;">
type: autre - laitier
</td>
<td style="text-align:right;">
1.55
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
12.52
</td>
</tr>
<tr>
<td style="text-align:left;">
type: cervidé - boucherie
</td>
<td style="text-align:right;">
1.87
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
7.11
</td>
</tr>
<tr>
<td style="text-align:left;">
type: autre - boucherie
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
8.40
</td>
</tr>
<tr>
<td style="text-align:left;">
type: autre - cervidé
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
4.26
</td>
</tr>
<tr>
<td style="text-align:left;">
age: 12-24 mois - 0-12 mois
</td>
<td style="text-align:right;">
14.49
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
151.20
</td>
</tr>
<tr>
<td style="text-align:left;">
age: &gt;24 mois - 0-12 mois
</td>
<td style="text-align:right;">
13.48
</td>
<td style="text-align:right;">
1.31
</td>
<td style="text-align:right;">
139.14
</td>
</tr>
<tr>
<td style="text-align:left;">
age: &gt;24 mois - 12-24 mois
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
2.82
</td>
</tr>
<tr>
<td style="text-align:left;">
sex: mâle - femelle
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
2.27
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="régression-binomiale-négative" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Régression binomiale négative<a href="régression-pour-données-de-compte-et-dincidence.html#régression-binomiale-négative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour effectuer une régression binomiale négative, vous devez utiliser la fonction <code>glm.nb()</code> de la librairie <code>MASS</code> comme suit.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb280-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb280-2" aria-hidden="true" tabindex="-1"></a>modele_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>tb, </span>
<span id="cb280-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb280-3" aria-hidden="true" tabindex="-1"></a>                    reactors <span class="sc">~</span> type <span class="sc">+</span> sex <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">offset</span>(log_par)</span>
<span id="cb280-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb280-4" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb280-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_nb)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = reactors ~ type + sex + age + offset(log_par), 
##     data = tb, init.theta = 0.5745887328, link = log)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.77667  -0.74441  -0.45509  -0.09632   2.70012  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -11.18145    0.92302 -12.114  &lt; 2e-16 ***
## typeboucherie   0.60461    0.62282   0.971 0.331665    
## typecervidé     0.66572    0.63176   1.054 0.291993    
## typeautre       0.80003    0.96988   0.825 0.409442    
## sexmâle        -0.05748    0.38337  -0.150 0.880819    
## age12-24 mois   2.25304    0.77915   2.892 0.003832 ** 
## age&gt;24 mois     2.48095    0.75283   3.296 0.000982 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(0.5746) family taken to be 1)
## 
##     Null deviance: 111.33  on 133  degrees of freedom
## Residual deviance:  99.36  on 127  degrees of freedom
## AIC: 331.47
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  0.575 
##           Std. Err.:  0.143 
## 
##  2 x log-likelihood:  -315.472</code></pre>
<p>Le paramètre de dispersion (Theta) et son erreur-type sont rapportés en bas.</p>
<div id="comparer-les-modèles-poisson-et-binomial-négatif" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Comparer les modèles Poisson et Binomial négatif<a href="régression-pour-données-de-compte-et-dincidence.html#comparer-les-modèles-poisson-et-binomial-négatif" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un test de rapport de vraisemblance peut être utilisé pour vérifier si l’ajout du facteur de dispersion est statistiquement significatif (i.e., pour vérifier si le modèle Binomial négatif est statistiquement meilleur que le Poisson).</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb282-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(modele_incid, </span>
<span id="cb282-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb282-3" aria-hidden="true" tabindex="-1"></a>       modele_nb)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: reactors ~ type + sex + age + offset(log_par)
## Model 2: reactors ~ type + sex + age + offset(log_par)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   7 -238.66                         
## 2   8 -157.74  1 161.85  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Dans ce cas, on note que l’ajout du facteur de dispersion est statistiquement significatif (<em>P</em> &lt; 0.001).</p>
</div>
<div id="évaluer-les-résiduels-dun-modèle-binomial-négatif" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Évaluer les résiduels d’un modèle Binomial négatif<a href="régression-pour-données-de-compte-et-dincidence.html#évaluer-les-résiduels-dun-modèle-binomial-négatif" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Malheureusement, la librairie <code>broom</code> que nous avons utilisée jusqu’à présent pour générer une table de diagnostic ne fonctionne plus avec le modèle Binomial négatif estimé avec la fonction <code>glm.nb()</code> de la librairie <code>MASS</code>. Ces résiduels peuvent cependant être générés avec la fonction <code>simulateResiduals()</code> de la librairie<code>DHARMa</code>.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb284-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Permet de générer des résiduels par simulation</span></span>
<span id="cb284-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-3" aria-hidden="true" tabindex="-1"></a>negbin_simulation <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> modele_nb)</span>
<span id="cb284-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Permet de visualiser les résiduels vs les valeurs prédites.</span></span>
<span id="cb284-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotSimulatedResiduals</span>(<span class="at">simulationOutput =</span> negbin_simulation)</span></code></pre></div>
<p><img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tester avec le Pearson chi-square test s&#39;il y a surdispersion </span></span>
<span id="cb285-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(negbin_simulation, <span class="at">type=</span><span class="st">&quot;PearsonChisq&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Parametric dispersion test via mean Pearson-chisq statistic
## 
## data:  negbin_simulation
## dispersion = 2.9516, df = 127, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided</code></pre>
<p>Dans ce cas, il semble y avoir encore une très légère surdispersion (Pearson/DDL=2.95 &gt; 1.25)…</p>
</div>
</div>
<div id="modèles-zéro-enflés" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Modèles zéro-enflés<a href="régression-pour-données-de-compte-et-dincidence.html#modèles-zéro-enflés" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="généralités-2" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Généralités<a href="régression-pour-données-de-compte-et-dincidence.html#généralités-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Parfois le nombre de zéros est plus grand ou plus petit que ce que l’on attend avec une distribution de Poisson ou Binomiale négative. On peut alors avoir recours à un modèle pour excès de zéros (un modèle zéros-enflés de Poisson ou zéros-enflés Binomial négatif, respectivement abréviés ZIP ou ZINB) ou le modèle à barrière (hurdle model). S’il n’y a pas de zéros, on peut alors utiliser un modèle à zéros tronqués (zero-truncated model) ou simplement soustraire la valeur 1 de notre variable dépendante.</p>
<p>Pour cette section, nous travaillerons avec la base de données <em>fec.csv</em>. Celle-ci décrit le nombre d’oeufs de parasite/5g de fèces en fonction de différents prédicteurs. Dans cet exemple, il n’y a pas de dénominateur à prendre en compte (i.e. pas de variable offset).</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous importons la base de données</span></span>
<span id="cb287-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-2" aria-hidden="true" tabindex="-1"></a>fec <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;fec.csv&quot;</span>, </span>
<span id="cb287-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb287-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep=</span><span class="st">&quot;;&quot;</span></span>
<span id="cb287-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-5" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb287-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous recodons certaines variables</span></span>
<span id="cb287-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-8" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>fec<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(fec<span class="sc">$</span>fec)</span>
<span id="cb287-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-9" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>lact)</span>
<span id="cb287-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-10" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>past_lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>past_lact)</span>
<span id="cb287-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-11" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>man_heif<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>man_heif)</span>
<span id="cb287-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-12" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>man_lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>man_lact)</span>
<span id="cb287-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualisons la base de données</span></span>
<span id="cb287-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb287-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fec)</span></code></pre></div>
<pre><code>##   province herd cow visit tx fec lact season past_lact man_heif man_lact
## 1        1    1  46     5  0   3    1      2         1        0        0
## 2        1    1  46     6  0   3    1      2         1        0        0
## 3        1    1  46     7  0  11    1      2         1        0        0
## 4        1    1  46     8  0   7    1      3         1        0        0
## 5        1    1  46     9  0  17    1      3         1        0        0
## 6        1    1  46    10  0   6    1      3         1        0        0</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution de notre variable dépendante (fec)</span></span>
<span id="cb289-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb289-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fec, </span>
<span id="cb289-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>fec)</span>
<span id="cb289-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-5" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb289-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, </span>
<span id="cb289-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb289-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Nombre d&#39;oeufs/5g de fèces&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Nombre de vaches&quot;</span>)</span></code></pre></div>
<p><img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>On note une distribution qui s’étire vers la droite et avec beaucoup de vaches avec la valeur zéro.</p>
<p>La fonction <code>zeroinfl()</code> de la librairie <code>pscl</code> permettra de générer les modèles zéros-enflés de Poisson ou Binomial négatif. Les modèles pour excès de zéros travaillent en appliquant simultanément une régression logistique et une régression de Poisson (ou Binomiale négative). Les deux parties du modèle peuvent avoir les mêmes prédicteurs, mais ce n’est pas obligatoire. Notez que la partie logistique du modèle prédit la probabilité d’avoir un compte de zéro (et donc les coefficients ont un signe opposé à ce qu’ils auraient dans une régression logistique « conventionnelle », où les “1” seraient prédits).</p>
<p>Le code suivant permet d’évaluer un modèle zéros-enflés Binomial négatif évaluant l’effet de différents prédicteurs (<em>lact</em>= multipare, <em>past_lac</em>= accès au pâturage, <em>man_heif</em>= fumier étendu sur pâturage des taures, <em>man_lac</em>=fumier étendu sur pâturage des vaches adultes) sur le compte d’œufs de parasites/5g de fèces.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb290-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-2" aria-hidden="true" tabindex="-1"></a>modele_zinb <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(<span class="at">data=</span>fec,</span>
<span id="cb290-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-3" aria-hidden="true" tabindex="-1"></a>                        fec <span class="sc">~</span> lact <span class="sc">+</span> past_lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact, </span>
<span id="cb290-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dist=</span><span class="st">&quot;negbin&quot;</span></span>
<span id="cb290-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-5" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb290-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_zinb)</span></code></pre></div>
<pre><code>## 
## Call:
## zeroinfl(formula = fec ~ lact + past_lact + man_heif + man_lact, data = fec, 
##     dist = &quot;negbin&quot;)
## 
## Pearson residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5055 -0.4537 -0.3624 -0.1425 27.3062 
## 
## Count model coefficients (negbin with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.36949    0.13117  18.064  &lt; 2e-16 ***
## lact1       -1.15848    0.10664 -10.864  &lt; 2e-16 ***
## past_lact1   0.53667    0.14233   3.771 0.000163 ***
## man_heif1   -0.99846    0.14216  -7.023 2.16e-12 ***
## man_lact1    1.07856    0.15789   6.831 8.43e-12 ***
## Log(theta)  -1.35981    0.05425 -25.065  &lt; 2e-16 ***
## 
## Zero-inflation model coefficients (binomial with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -0.9303     0.2932  -3.173  0.00151 ** 
## lact1         0.8700     0.3083   2.822  0.00478 ** 
## past_lact1   -1.8003     0.3990  -4.512 6.41e-06 ***
## man_heif1    -0.7701     0.4669  -1.649  0.09905 .  
## man_lact1   -12.0963   156.4271  -0.077  0.93836    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Theta = 0.2567 
## Number of iterations in BFGS optimization: 47 
## Log-likelihood: -5239 on 11 Df</code></pre>
<p>Notez que les résultats présentés sont passablement différents. Vous avez deux tables avec les estimés des paramètres, une (Count model coefficients) pour la partie binomiale négative (i.e. les comptes) et l’autre (Zero-inflation model coefficients) pour la partie zéros-enflés (i.e. la partie logistique ou, si vous préférez, l’excès de zéros).</p>
<p>On pourrait ajouter nos <em>IC95</em> et mettre nos coefficients à l’exposant pour mieux visualiser les résultats. Notez que la librairie <code>jtools</code> (qui faisait automatiquement de jolies tables de résultats) ne fonctionne pas avec ce genre de modèle. Dommage…</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LA PARTIE LOGISTIQUE</span></span>
<span id="cb292-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les coefficients et les erreurs types de la partie logistique (binomiale) du modèle dans une même table</span></span>
<span id="cb292-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-3" aria-hidden="true" tabindex="-1"></a>coefs_logi <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(modele_zinb)<span class="sc">$</span>coefficients<span class="sc">$</span>zero[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb292-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coefs_logi)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">&quot;SE&quot;</span></span>
<span id="cb292-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les IC95</span></span>
<span id="cb292-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-6" aria-hidden="true" tabindex="-1"></a>coefs_logi<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> coefs_logi<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>coefs_logi<span class="sc">$</span>SE</span>
<span id="cb292-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-7" aria-hidden="true" tabindex="-1"></a>coefs_logi<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> coefs_logi<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>coefs_logi<span class="sc">$</span>SE</span>
<span id="cb292-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Ici on pourrait déjà, si on le voulait, inverser tous les coefficients et les CI</span></span>
<span id="cb292-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre à l&#39;exposant les coefficients</span></span>
<span id="cb292-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-11" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs_logi)</span>
<span id="cb292-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer l&#39;intercept (la 1ère rangée) et les erreurs-types</span></span>
<span id="cb292-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-13" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> OR[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb292-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-14" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">subset</span>(OR, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(SE))</span>
<span id="cb292-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-17" aria-hidden="true" tabindex="-1"></a><span class="co"># LA PARTIE COMPTE</span></span>
<span id="cb292-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les coefficients et les erreurs types de la partie Binomiale négative du modèle dans une même table</span></span>
<span id="cb292-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-19" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(modele_zinb)<span class="sc">$</span>coefficients<span class="sc">$</span>count[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb292-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coefs)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">&quot;SE&quot;</span></span>
<span id="cb292-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les IC95</span></span>
<span id="cb292-22"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-22" aria-hidden="true" tabindex="-1"></a>coefs<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> coefs<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>coefs<span class="sc">$</span>SE</span>
<span id="cb292-23"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-23" aria-hidden="true" tabindex="-1"></a>coefs<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> coefs<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>coefs<span class="sc">$</span>SE</span>
<span id="cb292-24"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre à l&#39;exposant les coefficients</span></span>
<span id="cb292-25"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-25" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs)</span>
<span id="cb292-26"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer l&#39;intercept (la 1ère rangée), le paramètre de dispersion (la 6ième rangée) et les erreurs-types</span></span>
<span id="cb292-27"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-27" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> IR[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>), ]</span>
<span id="cb292-28"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-28" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> <span class="fu">subset</span>(IR, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(SE))</span>
<span id="cb292-29"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-30"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-31"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalement, on pourra demander à voir ces tables</span></span>
<span id="cb292-32"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb292-33"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb292-34"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-34" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(OR, <span class="at">digits=</span><span class="dv">2</span>), <span class="at">caption=</span><span class="st">&quot;Partie logistique du modèle zéro-enflé Binomial négatif (ZINB).&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb292-35"><a href="régression-pour-données-de-compte-et-dincidence.html#cb292-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-90">Table 8.3: </span>Partie logistique du modèle zéro-enflé Binomial négatif (ZINB).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
lact1
</td>
<td style="text-align:right;">
2.39
</td>
<td style="text-align:right;">
1.30
</td>
<td style="text-align:right;">
4.370000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
past_lact1
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
3.600000e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
man_heif1
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
1.160000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
man_lact1
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
7.945616e+127
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(IR, <span class="at">digits=</span><span class="dv">2</span>), <span class="at">caption=</span><span class="st">&quot;Partie binomiale négative du modèle zéro-enflé Binomial négatif (ZINB).&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb293-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-90">Table 8.3: </span>Partie binomiale négative du modèle zéro-enflé Binomial négatif (ZINB).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
lact1
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
past_lact1
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
2.26
</td>
</tr>
<tr>
<td style="text-align:left;">
man_heif1
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
man_lact1
</td>
<td style="text-align:right;">
2.94
</td>
<td style="text-align:right;">
2.16
</td>
<td style="text-align:right;">
4.01
</td>
</tr>
</tbody>
</table>
<p>L’interprétation des coefficients de régression, par exemple pour la variable <em>lact</em> (primipare=0 est la valeur de référence et multipare=1) se fera comme suit : Les vaches multipares avaient 2.4 fois (IC95: 1.3, 4.4) les odds d’avoir aucun œufs de parasites dans leurs fèces comparativement aux primipares et elles avaient 0.31 fois (IC95: 0.25, 0.39) le compte d’œufs de parasites des primipares.</p>
<p>Bien sûr, vous pouvez encore utiliser certaines fonctions que vous avez maintenant l’habitude d’utiliser, par exemple les fonctions <code>emmeans()</code> et <code>pairs()</code> du package <code>emmeans</code> .</p>
</div>
<div id="test-de-vuong-comparer-modèle-zéros-enflés-au-modèle-conventionnel" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Test de Vuong – Comparer modèle zéros-enflés au modèle conventionnel<a href="régression-pour-données-de-compte-et-dincidence.html#test-de-vuong-comparer-modèle-zéros-enflés-au-modèle-conventionnel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut vérifier si un modèle pour excès de zéros est plus approprié que le modèle de Poisson ou Binomial négatif équivalent grâce au test de Vuong. Pour ce faire, on devra d’abord générer un objet modèle Poisson et un autre objet modèle zéro-enflé Poisson (ou un Binomial négatif et un zéro-enflé Binomial négatif). Ensuite, la fonction <code>vuong()</code> de la librairie <code>pscl</code> permettra de comparer ces modèles.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le modèle NB</span></span>
<span id="cb294-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb294-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-3" aria-hidden="true" tabindex="-1"></a>modele_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>fec, </span>
<span id="cb294-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-4" aria-hidden="true" tabindex="-1"></a>                    fec <span class="sc">~</span> lact <span class="sc">+</span> past_lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact</span>
<span id="cb294-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-5" aria-hidden="true" tabindex="-1"></a>                    ) </span>
<span id="cb294-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Le modèle ZINB</span></span>
<span id="cb294-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb294-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-9" aria-hidden="true" tabindex="-1"></a>modele_zinb <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(<span class="at">data=</span>fec, </span>
<span id="cb294-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-10" aria-hidden="true" tabindex="-1"></a>                        fec <span class="sc">~</span> lact <span class="sc">+</span> past_lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact, </span>
<span id="cb294-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dist=</span><span class="st">&quot;negbin&quot;</span></span>
<span id="cb294-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-12" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb294-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Le test de Vuong</span></span>
<span id="cb294-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-15" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(modele_nb, </span>
<span id="cb294-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb294-16" aria-hidden="true" tabindex="-1"></a>      modele_zinb)</span></code></pre></div>
<pre><code>## Vuong Non-Nested Hypothesis Test-Statistic: 
## (test-statistic is asymptotically distributed N(0,1) under the
##  null that the models are indistinguishible)
## -------------------------------------------------------------
##               Vuong z-statistic             H_A    p-value
## Raw                  -3.3087359 model2 &gt; model1 0.00046859
## AIC-corrected        -2.6889996 model2 &gt; model1 0.00358332
## BIC-corrected        -0.9169612 model2 &gt; model1 0.17958149</code></pre>
<p>Trois tests statistiques différents sont réalisés. Dans tous les cas le modèle zéros-enflés (le #2) semble préférable et deux de ces tests indiquent une différence statistiquement significative entre les modèles ZINB et NB.</p>
</div>
</div>
<div id="calcul-du-risque-relatif-à-laide-dune-régression-de-poisson" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Calcul du risque relatif à l’aide d’une régression de Poisson<a href="régression-pour-données-de-compte-et-dincidence.html#calcul-du-risque-relatif-à-laide-dune-régression-de-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Avec une variable dépendante qui ne peut prendre que 2 valeurs (0/1), on utilise en général la régression logistique et ont présente donc un rapport de cotes (i.e. un odds ratio). Dans certaines situations, cependant, on préfèrerait présenter un risque relatif plutôt qu’un rapport de cotes. Par exemple, pour faciliter la compréhension des résultats (i.e. le risque relatif est plus facile à comprendre que le rapport de cotes) ou pour permettre le calcul d’autres mesures d’association (e.g. la fraction attribuable dans la population).</p>
<p>Si la maladie est rare (prévalence &lt; 5%), le rapport de cotes ≈ le risque relatif. Mais si la maladie est relativement fréquente, on ne pourra se servir de cette particularité. On peut, cependant, utiliser une régression de Poisson et un lien log avec une variable dépendante binaire. L’exposant des coefficients sera alors un risque relatif (plutôt qu’un rapport de cotes). Les IC 95% seront, cependant, un peu trop conservateurs (i.e. trop larges). On pourra y remédier en utilisant des erreurs-types robustes. Voir (Barros et Hirakata, 2003.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> pour plus de détails.</p>
<p>Le code suivant permet de calculer des risques relatifs (plutôt que des rapports de cotes) pour le risque de Nocardiose en fonction des traitements au tarissement utilisés.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous importons le jeu de données</span></span>
<span id="cb296-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-2" aria-hidden="true" tabindex="-1"></a>nocardia <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;nocardia.csv&quot;</span>, </span>
<span id="cb296-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb296-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sep=</span><span class="st">&quot;;&quot;</span></span>
<span id="cb296-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-5" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb296-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous indiquons les variables catégoriques dans le jeu de données</span></span>
<span id="cb296-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-8" aria-hidden="true" tabindex="-1"></a>nocardia<span class="sc">$</span>dbarn <span class="ot">&lt;-</span> <span class="fu">factor</span>(nocardia<span class="sc">$</span>dbarn) </span>
<span id="cb296-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-9" aria-hidden="true" tabindex="-1"></a>nocardia<span class="sc">$</span>dneo <span class="ot">&lt;-</span> <span class="fu">factor</span>(nocardia<span class="sc">$</span>dneo) </span>
<span id="cb296-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-10" aria-hidden="true" tabindex="-1"></a>nocardia<span class="sc">$</span>dclox <span class="ot">&lt;-</span> <span class="fu">factor</span>(nocardia<span class="sc">$</span>dclox) </span>
<span id="cb296-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous effectuons une régression de Poisson</span></span>
<span id="cb296-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-13" aria-hidden="true" tabindex="-1"></a>modele_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>nocardia,</span>
<span id="cb296-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-14" aria-hidden="true" tabindex="-1"></a>                      casecont <span class="sc">~</span> dclox <span class="sc">+</span> dneo <span class="sc">+</span> dcpct, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span></span>
<span id="cb296-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-15" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb296-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous demandons la variance robuste</span></span>
<span id="cb296-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb296-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-19" aria-hidden="true" tabindex="-1"></a>rob_SE <span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(modele_poisson)))</span>
<span id="cb296-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Pour faciliter la lecture, nous pourrions ajouter ces erreurs-types robustes à nos coefficients dans une table</span></span>
<span id="cb296-22"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-22" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">Estimate=</span>modele_poisson<span class="sc">$</span>coefficients, </span>
<span id="cb296-23"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">robust_SE=</span>rob_SE)</span>
<span id="cb296-24"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-24" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb296-25"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-26"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Puis calculer les IC95</span></span>
<span id="cb296-27"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-27" aria-hidden="true" tabindex="-1"></a>tab_SE<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> tab_SE<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>tab_SE<span class="sc">$</span>robust_SE</span>
<span id="cb296-28"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-28" aria-hidden="true" tabindex="-1"></a>tab_SE<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> tab_SE<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>tab_SE<span class="sc">$</span>robust_SE</span>
<span id="cb296-29"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-30"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Enlever l&#39;intercept, les SE et mettre tout à l&#39;exposant pour avoir des RR </span></span>
<span id="cb296-31"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-31" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> tab_SE[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb296-32"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-32" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">subset</span>(tab_SE, </span>
<span id="cb296-33"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(robust_SE)</span>
<span id="cb296-34"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-34" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb296-35"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-35" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb296-36"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-37"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb296-38"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb296-39"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(tab_SE, <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb296-40"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;Modèle de Poisson avec erreurs-types robustes pour estimer le risque relatif de Nocardiose.&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb296-41"><a href="régression-pour-données-de-compte-et-dincidence.html#cb296-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-92">Table 8.4: </span>Modèle de Poisson avec erreurs-types robustes pour estimer le risque relatif de Nocardiose.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
dclox1
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
1.02
</td>
</tr>
<tr>
<td style="text-align:left;">
dneo1
</td>
<td style="text-align:right;">
3.56
</td>
<td style="text-align:right;">
1.55
</td>
<td style="text-align:right;">
8.14
</td>
</tr>
<tr>
<td style="text-align:left;">
dcpct
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.02
</td>
</tr>
</tbody>
</table>
<p>Le risque relatif (RR) de Nocardiose dans les troupeaux utilisant la néomycine (<em>vs.</em> ceux qui ne l’utilisaient pas) était est donc de 3.56 (IC95: 1.55, 8.14).</p>
</div>
<div id="travaux-pratiques-6---régression-de-poisson-et-binomiale-négative" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Travaux pratiques 6 - Régression de Poisson et Binomiale négative<a href="régression-pour-données-de-compte-et-dincidence.html#travaux-pratiques-6---régression-de-poisson-et-binomiale-négative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercices-5" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Exercices<a href="régression-pour-données-de-compte-et-dincidence.html#exercices-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour ce TP utilisez le fichier TB_real (voir description VER p.836).</p>
<p>Dans cette étude nous sommes intéressés à décrire les facteurs de risque associés à l’incidence d’animaux positifs à la tuberculose. L’incidence est définie à l’aide des variables <em>reactors</em> (le nombre d’animaux positif sur une ferme) et <em>par</em> (le nombre d’animal-jour à risque sur cette ferme).</p>
<ol style="list-style-type: decimal">
<li><p>Quel genre de valeurs la variable <em>reactors</em> prend-t’elle? Évaluer graphiquement la distribution de la variable <em>reactors</em>. Quel genre de distribution la variable <em>reactors</em> semble-t-elle suivre ? Justifiez.</p></li>
<li><p>Évaluez graphiquement la distribution du nombre d’animal-jour à risque (variable <em>par</em>). Y-a-t-il beaucoup de variation d’une ferme à l’autre ? Comment pourrez-vous tenir compte de ces différences dans un modèle de régression de Poisson ?</p></li>
<li><p>Évaluer l’effet du type d’élevage (i.e. la variable <em>type</em>) sur l’incidence d’animaux positifs à la tuberculose (<em>reactors</em>) tout en prenant en compte les nombres différents d’animal-jour à risque dans chacune des fermes.</p></li>
</ol>
<p>3.1. Est-ce que la variable <em>type</em> est significativement associée à l’incidence de tuberculose (i.e. est-ce qu’au moins un des coefficients de régression des variables indicateurs est différent de zéro)?</p>
<p>3.2. Quels sont les ratios d’incidence, leurs <em>IC 95%</em> et les valeurs de <em>P</em> pour chacun des types d’élevage (utilisez laitier comme valeur de référence)?</p>
<p>3.3. Comment interprétez-vous le ratio d’incidence des cervidés?</p>
<p>3.4. Bien certainement, vous vous rappelez que vous devez ajuster ces <em>IC 95%</em> et valeurs de <em>P</em> pour les comparaisons multiples… Effectuez cet ajustement à l’aide de la méthode Tukey-Kramer. Les <em>IC 95%</em> et valeurs de <em>P</em> sont-elles maintenant plus grandes ou plus petites?</p>
<p>3.5. Est-ce que ce modèle semble adéquat pour ces données?</p>
<p>3.6. Y-a-t-il sur-dispersion? Si c’est le cas, quelles options avez-vous afin d’améliorer votre modèle?</p>
<p>3.7. Évaluez les ratios d’incidence, leurs <em>IC 95%</em> et les valeurs de <em>P</em> pour chacun des types d’élevage, mais à l’aide des erreurs-types robustes et en ajustant pour les comparaisons multiples. Est-ce que la variable <em>type</em> est toujours significativement associée à l’incidence de tuberculose (i.e. est-ce qu’au moins un des coefficients de régression des variables indicateurs est différent de zéro)?</p>
<p>3.8. Un modèle de régression binomiale négative permettrait peut-être de modéliser correctement cette sur-dispersion. Évaluez un tel modèle. Est-ce que le paramètre de dispersion semble significativement différent de zéro? Effectuez un test de rapport de vraisemblance comparant les modèles de régression binomial négative et de Poisson.</p>
<p>3.9. Comparez graphiquement le compte d’animaux positifs à la tuberculose prédits par ce dernier modèle et les comptes réels d’animaux positifs. Que notez-vous?</p>
</div>
<div id="code-r-et-réponses-5" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Code R et réponses<a href="régression-pour-données-de-compte-et-dincidence.html#code-r-et-réponses-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour ce TP utilisez le fichier TB_real (voir description VER p.836).</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous importons le jeu de données</span></span>
<span id="cb297-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb297-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;tb_real.csv&quot;</span>,</span>
<span id="cb297-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb297-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb297-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb297-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb297-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb)</span></code></pre></div>
<pre><code>##   obs farm_id type sex age reactors  par
## 1   1    4002    2   0   0        1  525
## 2   2    4002    2   0   1        2 3675
## 3   3    4002    2   0   2        5 5775
## 4   4    4002    2   1   1        3 2625
## 5   5    4002    2   1   2        1  525
## 6   6    4003    2   0   2        2 7824</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous indiquons les variables catégoriques dans le jeu de données. Nous allons aussi ajouter des étiquettes pour faciliter l&#39;interprétation plus tard.</span></span>
<span id="cb299-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-2" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>farm_id <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>farm_id) </span>
<span id="cb299-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-3" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>type, </span>
<span id="cb299-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), </span>
<span id="cb299-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;laitier&quot;</span>,</span>
<span id="cb299-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;boucherie&quot;</span>, </span>
<span id="cb299-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;cervidé&quot;</span>, </span>
<span id="cb299-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;autre&quot;</span>)</span>
<span id="cb299-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-9" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb299-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-10" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>sex, </span>
<span id="cb299-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb299-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;femelle&quot;</span>,</span>
<span id="cb299-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;mâle&quot;</span>)</span>
<span id="cb299-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-14" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb299-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-15" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">factor</span>(tb<span class="sc">$</span>age, </span>
<span id="cb299-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>), </span>
<span id="cb299-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0-12 mois&quot;</span>,</span>
<span id="cb299-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-18" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;12-24 mois&quot;</span>,</span>
<span id="cb299-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-19" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;&gt;24 mois&quot;</span>)</span>
<span id="cb299-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb299-20" aria-hidden="true" tabindex="-1"></a>                 )</span></code></pre></div>
<p>Dans cette étude nous sommes intéressés à décrire les facteurs de risque associés à l’incidence d’animaux positifs à la tuberculose. L’incidence est définie à l’aide des variables <em>reactors</em> (le nombre d’animaux positif sur une ferme) et <em>par</em> (le nombre d’animal-jour à risque sur cette ferme).</p>
<ol style="list-style-type: decimal">
<li>Quel genre de valeurs la variable <em>reactors</em> prend-t’elle? Évaluer graphiquement la distribution de la variable <em>reactors</em>. Quel genre de distribution la variable <em>reactors</em> semble-t-elle suivre ? Justifiez.</li>
</ol>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb300-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(tb<span class="sc">$</span>reactors), </span>
<span id="cb300-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb300-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&#39;render&#39;</span>)</span></code></pre></div>
<div class="container st-container">
<h3>Data Frame Summary</h3>
<h4>tb</h4>
<strong>Dimensions</strong>: 134 x 1
  <br/><strong>Duplicates</strong>: 121
<br/>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>No</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Valid</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">tb
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 1.5 (4)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min &le; med &le; max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0 &le; 0 &le; 29</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 1 (2.8)</td></tr></table></td>
      <td align="left" style="vertical-align:middle">13 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5wETFgAeWv2y+gAAAFtJREFUaN7tzrERgDAIQFFWcIW4gdl/N5uc0nhypH2/4igeRKjTSB3tFnbOpwsGg8FgMBgMBoPBYDAYDAaDwWAwGAwGg8Fgu9j4r4694/xY5+fzjYUVvikU6nQDOpCAJDKQcEwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDEtMTlUMjI6MDA6MzArMDA6MDC3ZvhyAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAxLTE5VDIyOjAwOjMwKzAwOjAwxjtAzgAAAABJRU5ErkJggg=="></td>
      <td align="center">134
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 1.0.1 (<a href='https://www.r-project.org/'>R</a> version 4.2.0)<br/>2023-01-19</p>
</div>
<p><strong>Réponse:</strong> <em>reactors</em> ne prend que des valeurs entières positives (0, 1, 2, 3, …). <em>reactors</em> représente des données de comptes et semble suivre une distribution de Poisson:
-les données de petite valeur sont fréquentes (0, 1, 2),
-à partir d’une certaine valeur, la fréquence décroît rapidement,</p>
<ol start="2" style="list-style-type: decimal">
<li>Évaluez graphiquement la distribution du nombre d’animal-jour à risque (variable <em>par</em>). Y-a-t-il beaucoup de variation d’une ferme à l’autre ? Comment pourrez-vous tenir compte de ces différences dans un modèle de régression de Poisson ?</li>
</ol>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb301-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(tb<span class="sc">$</span>par), </span>
<span id="cb301-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb301-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&#39;render&#39;</span>)</span></code></pre></div>
<div class="container st-container">
<h3>Data Frame Summary</h3>
<h4>tb</h4>
<strong>Dimensions</strong>: 134 x 1
  <br/><strong>Duplicates</strong>: 14
<br/>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>No</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Valid</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">tb
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 7968.6 (15878.1)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min &le; med &le; max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">30 &le; 2135.5 &le; 118084</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 7149 (2)</td></tr></table></td>
      <td align="left" style="vertical-align:middle">120 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5wETFgAeWv2y+gAAAGtJREFUaN7t2bERgCAMQFFW0A3EDXD/3TyBgkaLwFm9X3AUudelSkqKlGvHNlfHzusJBoPBYDAYDAaDwWAwGAwGg8FgMBgMBluG7e2gNY01pn7LNFbfAoP9h0Xuuq/YsBKf+zWOdCwvKSnSDRuEQdp4oaJrAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTAxLTE5VDIyOjAwOjMwKzAwOjAwt2b4cgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wMS0xOVQyMjowMDozMCswMDowMMY7QM4AAAAASUVORK5CYII="></td>
      <td align="center">134
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 1.0.1 (<a href='https://www.r-project.org/'>R</a> version 4.2.0)<br/>2023-01-19</p>
</div>
<p><strong>Réponse:</strong> Oui, beaucoup de fermes ont peu d’animal-jour à risque (i.e. elles comptaient peu d’animaux et/ou elles avaient été suivies pendant peu de jours) alors que d’autres ont des valeurs de <em>par</em> élevées. Ces différences pourraient être gérées dans une régression de Poisson en spécifiant une variable offset qui sera en fait le logarithme naturel de <em>par</em>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Évaluer l’effet du type d’élevage (i.e. la variable <em>type</em>) sur l’incidence d’animaux positifs à la tuberculose (<em>reactors</em>) tout en prenant en compte les nombres différents d’animal-jour à risque dans chacune des fermes.</li>
</ol>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous devons d&#39;abord créer un offset en transformant la variable &quot;par&quot; sur une échelle logarithmique</span></span>
<span id="cb302-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-2" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>log_par <span class="ot">&lt;-</span> <span class="fu">log</span>(tb<span class="sc">$</span>par)</span>
<span id="cb302-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensuite nous générons un objet modèle, pour une régression de Poisson, le prédicteur &quot;type&quot; et le offset &quot;log_par&quot;</span></span>
<span id="cb302-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-5" aria-hidden="true" tabindex="-1"></a>modele_incid<span class="ot">&lt;-</span><span class="fu">glm</span>(<span class="at">data=</span>tb, </span>
<span id="cb302-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-6" aria-hidden="true" tabindex="-1"></a>                  reactors <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">offset</span>(log_par), </span>
<span id="cb302-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family=</span><span class="st">&quot;poisson&quot;</span></span>
<span id="cb302-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb302-8" aria-hidden="true" tabindex="-1"></a>                  )</span></code></pre></div>
<p>3.1. Est-ce que la variable <em>type</em> est significativement associée à l’incidence de tuberculose (i.e. est-ce qu’au moins un des coefficients de régression des variables indicatrices est différent de zéro)?</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_incid)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactors ~ type + offset(log_par), family = &quot;poisson&quot;, 
##     data = tb)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.7137  -1.1568  -0.4825  -0.1190   9.0537  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -9.1000     0.2000 -45.500  &lt; 2e-16 ***
## typeboucherie   0.3294     0.2353   1.400 0.161603    
## typecervidé     0.8122     0.2232   3.639 0.000273 ***
## typeautre       0.3063     0.6110   0.501 0.616102    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 409.03  on 133  degrees of freedom
## Residual deviance: 390.50  on 130  degrees of freedom
## AIC: 527.47
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p><strong>Réponse:</strong> Ici ont voit que cervidés semble différent de la valeur de référence (laitier). Mais ce serait préférable de faire un test de rapport de vraisemblance sur l’ensemble des variables indicateurs.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb305-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(modele_incid) <span class="co">#test du rapport de vraisemblance du modèle</span></span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: reactors ~ type + offset(log_par)
## Model 2: reactors ~ 1
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   4 -259.74                         
## 2   1 -396.90 -3 274.32  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Réponse:</strong> Le test de rapport de vraisemblance comparant le modèle avec la variable <em>type</em> et sans celle-ci est significatif (<em>P</em>&lt;0.001).</p>
<p>3.2. Quels sont les ratios d’incidence et leurs <em>IC 95%</em> pour chacun des types d’élevage (utilisez laitier comme valeur de référence)?</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comme laitier est déjà la valeur de référence, nous pouvons simplement faire:</span></span>
<span id="cb307-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb307-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons la librairie jtools pour obtenir une table avec les coefficients et les IC95</span></span>
<span id="cb307-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-4" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">summ</span>(modele_incid, </span>
<span id="cb307-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">confint =</span> <span class="cn">TRUE</span>)</span>
<span id="cb307-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons round pour ajuster la précision des valeurs dans les tables</span></span>
<span id="cb307-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(j<span class="sc">$</span>coeftable), </span>
<span id="cb307-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb307-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##               Est. 2.5% 97.5% z val.    p
## (Intercept)   0.00 0.00  0.00   0.00 1.00
## typeboucherie 1.39 0.88  2.20   4.05 1.18
## typecervidé   2.25 1.45  3.49  38.07 1.00
## typeautre     1.36 0.41  4.50   1.65 1.85</code></pre>
<p><strong>Réponse:</strong> Pour ce calcul, on aurait aussi pu simplement faire l’exposant des coefficients et des IC 95% rapportés à l’aide de ma fonction <code>summary()</code>.</p>
<p>3.3. Comment interprétez-vous le ratio d’incidence des cervidés?</p>
<p><strong>Réponse:</strong> L’incidence de tuberculose est 2.25 fois plus élevée (IC95: 1.45, 3.49) dans les élevages de cervidés comparativement aux élevages laitiers.</p>
<p>3.4. Bien certainement, vous vous rappelez que vous devez ajuster ces <em>IC 95%</em> et valeurs de <em>P</em> pour les comparaisons multiples… Effectuez cet ajustement à l’aide de la méthode Tukey-Kramer. Les <em>IC 95%</em> sont-elles maintenant plus grands ou plus petits?</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb309-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-2" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modele_incid, </span>
<span id="cb309-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>)) </span>
<span id="cb309-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Notez ici, nous avons ajouté l&#39;option &quot;reverse=TRUE&quot; pour présenter les comparaisons dans l&#39;autre sens (i.e., comme dans le summary()). </span></span>
<span id="cb309-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">pairs</span>(contrast, </span>
<span id="cb309-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">reverse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb309-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb309-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb309-8" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<pre><code>##  contrast            ratio    SE  df asymp.LCL asymp.UCL
##  boucherie / laitier 1.390 0.327 Inf     0.759      2.54
##  cervidé / laitier   2.253 0.503 Inf     1.270      4.00
##  cervidé / boucherie 1.621 0.257 Inf     1.078      2.44
##  autre / laitier     1.358 0.830 Inf     0.283      6.53
##  autre / boucherie   0.977 0.577 Inf     0.214      4.45
##  autre / cervidé     0.603 0.353 Inf     0.134      2.72
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 4 estimates 
## Intervals are back-transformed from the log scale</code></pre>
<p><strong>Réponse:</strong> Bien évidemment les IC 95% sont plus larges (par exemple 1.27, 4.0 après ajustement pour les comparaisons multiples <em>vs.</em> 1.45, 3.49).</p>
<p>3.5. Est-ce que ce modèle semble adéquat pour ces données?</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb311-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-2" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> <span class="fu">augment</span>(modele_incid, </span>
<span id="cb311-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">type.residuals =</span> <span class="st">&quot;pearson&quot;</span>) <span class="co">#Nous venons de créer une nouvelle table avec les résiduels, etc. </span></span>
<span id="cb311-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous calculons la somme de ces résiduels au carré. Dans ce cas: 791.0</span></span>
<span id="cb311-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span>(diag<span class="sc">$</span>.resid<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb311-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb311-7" aria-hidden="true" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>## [1] 791.0448</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous vérifions à quelle probabilité la valeur 791.0 correspond dans une distribution de chi-carré avec les degrés de liberté (n - le nombre de coefficients-1).</span></span>
<span id="cb313-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb313-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(s, </span>
<span id="cb313-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb313-3" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">134-3-1</span>))</span>
<span id="cb313-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb313-4" aria-hidden="true" tabindex="-1"></a>P</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><strong>Réponse:</strong> Le test de <span class="math inline">\(X^2\)</span> de Pearson donne une valeur de <em>P</em> &lt; 0.001, l’hypothèse nulle doit donc être rejetée, le modèle n’est pas adéquat pour les données.</p>
<p>3.6. Y-a-t-il sur-dispersion? Si c’est le cas, quelles options avez-vous afin d’améliorer votre modèle?</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous pouvons calculer le paramètre de dispersion</span></span>
<span id="cb315-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb315-2" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> s<span class="sc">/</span>(<span class="dv">134-3-1</span>)</span>
<span id="cb315-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb315-3" aria-hidden="true" tabindex="-1"></a>disp</span></code></pre></div>
<pre><code>## [1] 6.08496</code></pre>
<p><strong>Réponse:</strong> La somme des résiduels de Pearson/ddl = 6.08, il y a donc surdispersion (i.e. &gt;1.25). Plusieurs options permettraient de contrôler ce problème, entre autres l’utilisation d’erreurs-type « scaled » ou robustes ou l’utilisation d’un modèle de régression binomiale négative.</p>
<p>3.7. Évaluez les ratios d’incidence, leurs <em>IC 95%</em> et les valeurs de <em>P</em> pour chacun des types d’élevage, mais à l’aide des erreurs-types robustes et en ajustant pour les comparaisons multiples. Est-ce que la variable <em>type</em> est toujours significativement associée à l’incidence de tuberculose (i.e. est-ce qu’au moins un des coefficients de régression des variables indicateurs est différent de zéro)?</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb317-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb317-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Ici nous demandons les comparaisons avec ajustement de Tukey et les erreurs-types robustes</span></span>
<span id="cb317-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-4" aria-hidden="true" tabindex="-1"></a>tukey <span class="ot">&lt;-</span> <span class="fu">glht</span>(modele_incid, </span>
<span id="cb317-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">type=</span><span class="st">&quot;Tukey&quot;</span>), </span>
<span id="cb317-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">vcov =</span> sandwich)</span>
<span id="cb317-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="co">#On ajoute les IC95</span></span>
<span id="cb317-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-9" aria-hidden="true" tabindex="-1"></a>with_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(tukey)</span>
<span id="cb317-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-11" aria-hidden="true" tabindex="-1"></a><span class="co">#On les transforme en IR</span></span>
<span id="cb317-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-12" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="ot">&lt;-</span> <span class="fu">exp</span>(with_ci<span class="sc">$</span>confint)</span>
<span id="cb317-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-14" aria-hidden="true" tabindex="-1"></a><span class="co">#On présente la table en arrondissant les IR à 2 décimales.</span></span>
<span id="cb317-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb317-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb317-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(tukey_results, <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb317-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;IR du modèle de Poisson avec erreurs-types robustes et IC95 ajustées pour comparaisons multiples.&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb317-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb317-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-274">Table 8.5: </span>IR du modèle de Poisson avec erreurs-types robustes et IC95 ajustées pour comparaisons multiples.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
boucherie - laitier
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
4.23
</td>
</tr>
<tr>
<td style="text-align:left;">
cervidé - laitier
</td>
<td style="text-align:right;">
2.25
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
6.61
</td>
</tr>
<tr>
<td style="text-align:left;">
autre - laitier
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
8.00
</td>
</tr>
<tr>
<td style="text-align:left;">
cervidé - boucherie
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
5.22
</td>
</tr>
<tr>
<td style="text-align:left;">
autre - boucherie
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
6.10
</td>
</tr>
<tr>
<td style="text-align:left;">
autre - cervidé
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
3.68
</td>
</tr>
</tbody>
</table>
<p><strong>Réponse:</strong> Non la variable <em>type</em> n’est plus associée à l’incidence de tuberculose.</p>
<p>3.8. Un modèle de régression binomiale négative permettrait peut-être de modéliser correctement cette sur-dispersion. Évaluez un tel modèle. Est-ce que le paramètre de dispersion semble significativement différent de zéro? Effectuez un test de rapport de vraisemblance comparant les modèles de régression binomial négative et de Poisson.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Le modèle Binomial négatif</span></span>
<span id="cb318-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb318-2" aria-hidden="true" tabindex="-1"></a>modele_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>tb,</span>
<span id="cb318-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb318-3" aria-hidden="true" tabindex="-1"></a>                    reactors <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">offset</span>(log_par)</span>
<span id="cb318-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb318-4" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb318-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_nb)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = reactors ~ type + offset(log_par), data = tb, 
##     init.theta = 0.4472788933, link = log)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5695  -0.8400  -0.5043  -0.1769   2.6508  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -8.8516     0.5846 -15.143   &lt;2e-16 ***
## typeboucherie   0.5412     0.6461   0.838    0.402    
## typecervidé     0.5163     0.6441   0.801    0.423    
## typeautre       0.8685     1.0054   0.864    0.388    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(0.4473) family taken to be 1)
## 
##     Null deviance: 98.108  on 133  degrees of freedom
## Residual deviance: 97.297  on 130  degrees of freedom
## AIC: 335.44
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  0.447 
##           Std. Err.:  0.107 
## 
##  2 x log-likelihood:  -325.438</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb320-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(modele_incid,</span>
<span id="cb320-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb320-3" aria-hidden="true" tabindex="-1"></a>       modele_nb)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: reactors ~ type + offset(log_par)
## Model 2: reactors ~ type + offset(log_par)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   4 -259.74                         
## 2   5 -162.72  1 194.04  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Réponse:</strong> Le test de rapport de vraisemblance indique que le modèle Binomial négatif est statistiquement meilleur que le modèle de Poisson (<em>P</em> &lt;0.001).</p>
<p>3.9. Comparez graphiquement le compte d’animaux positifs à la tuberculose prédits par ce dernier modèle et les comptes réels d’animaux positifs. Que notez-vous?</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En premier, nous réunissons les valeurs observées et prédites dans un jeu de données.</span></span>
<span id="cb322-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-2" aria-hidden="true" tabindex="-1"></a>obs_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">obs=</span>modele_nb<span class="sc">$</span>y, </span>
<span id="cb322-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pred=</span>modele_nb<span class="sc">$</span>fitted.values)</span>
<span id="cb322-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-4" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb322-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensuite on génère les deux polygones de fréquence dans une même figure.</span></span>
<span id="cb322-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb322-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>obs_pred, </span>
<span id="cb322-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>obs)</span>
<span id="cb322-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-10" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb322-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span> <span class="co">#Nous demandons d&#39;abord une ligne pour les valeurs observées</span></span>
<span id="cb322-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co">#Nous demandons à ne pas avoir de légende dans ce cas</span></span>
<span id="cb322-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pred, </span>
<span id="cb322-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb322-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-15" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> <span class="co">#Nous demandons ensuite une ligne pour les valeurs prédites</span></span>
<span id="cb322-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span> <span class="co">#On enlève les valeurs sous zéro</span></span>
<span id="cb322-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb322-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co">#Un thème blanc</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-276"></span>
<img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-276-1.png" alt="Comparaison des comptes d'animaux réactifs observés (bleu) et prédits (rouge)." width="672" />
<p class="caption">
Figure 8.2: Comparaison des comptes d’animaux réactifs observés (bleu) et prédits (rouge).
</p>
</div>
<p><strong>Réponse:</strong> On note que le modèle prédit moins de troupeaux avec près de 0 animal positif (environ 60% des troupeaux) que la réalité (environ 87%). Par contre, le modèle est capable de prédire des comptes assez élevés (jusqu’à 25 animaux réactifs).</p>
</div>
</div>
<div id="travaux-pratiques-7---modèles-modifiés-en-zéro-et-calcul-dun-risque-relatif" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Travaux pratiques 7 - Modèles modifiés en zéro et calcul d’un risque relatif<a href="régression-pour-données-de-compte-et-dincidence.html#travaux-pratiques-7---modèles-modifiés-en-zéro-et-calcul-dun-risque-relatif" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercices-6" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Exercices<a href="régression-pour-données-de-compte-et-dincidence.html#exercices-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour les questions 1 à 3 du TP utilisez le fichier <em>fec.csv</em> (voir description VER p.811).</p>
<p>Dans cette étude nous souhaitons décrire les facteurs de risque associés au compte d’oeufs de parasites dans les fèces de bovins laitiers. La variable <em>fec</em> représente le nombre d’oeufs/5g de fèces qui pourra être prédit en fonction de différents prédicteurs. Dans cet exemple il n’y a pas de dénominateur à considérer (i.e. une variable offset n’est pas nécessaire; chaque animal a été échantillonné une seule fois).</p>
<ol style="list-style-type: decimal">
<li><p>D’abord représenter graphiquement la variable <em>fec</em>. S’agit-il d’une distribution typique pour une donnée de compte? Quelle proportion des observations avait un compte de zéro oeuf?</p></li>
<li><p>Essayez d’abord de modéliser l’effet de <em>tx</em> (un traitement à l’Eprinomectin au vêlage) sur le compte d’oeuf (<em>fec</em>) en prenant en compte les facteurs confondants <em>lact</em>, <em>man_heif</em> et <em>man_lact</em> à l’aide d’une régression binomiale négative.</p></li>
</ol>
<p>2.1. D’abord, est-ce que le paramètre de dispersion (i.e. le α) est statistiquement différent de zéro? Qu’est-ce que cela vous indique?</p>
<p>2.2. Est-ce que le modèle est adéquat pour vos données?</p>
<p>2.3. Vérifiez si un modèle zéros-enflé Binomial négatif (ZINB) serait préférable à un modèle Binomial négatif.</p>
<p>2.4. À l’aide de ce dernier modèle, expliquez l’effet du traitement à l’Eprinomectin sur le compte d’oeufs de parasite.</p>
<p>Pour la question 3 du TP utilisez le fichier <em>daisy2.csv</em> (voir description VER p.809).</p>
<p>Ne sélectionnez que les 7 troupeaux avec <em>H7</em>=1 et n’utilisez que la 1ère lactation de chaque vache (<em>study_lact</em>=1).</p>
<ol start="3" style="list-style-type: decimal">
<li>Dans cette étude on se demande si une rétention placentaire (<em>rp</em>) affecte la probabilité de conception à la première saillie (<em>fs</em>) après avoir contrôlé pour l’âge de la vache (<em>parity</em>). Les chercheurs désirent calculer la fraction attribuable dans la population (<em>AFp</em>).</li>
</ol>
<p><span class="math inline">\(AF_p = (P(E+)(RR-1))/(P(E+)(RR-1)+1))\)</span></p>
<p>3.1. Dans ce cas, est-ce que ce serait correct de remplacer le risque relatif dans l’équation précédente par un rapport de cotes estimé à l’aide d’un modèle de régression logistique?</p>
<p>3.2. Quel serait le risque relatif de conception à la 1ère saillie et son IC 95% lorsque rétention placentaire est présent <em>vs.</em> absent et après ajustement pour l’âge de la vache?</p>
<p>3.3. Quelle serait la fraction attribuable (<em>AFp</em>) dans la population due aux rétentions placentaires? Comment interprétez-vous ce résultat?</p>
<p>3.4. Question bonus (i.e. vous aurez 2 banana-points supplémentaires si vous répondez correctement): Comment pourriez-vous obtenir un IC 95% pour l’<em>AFp</em>?</p>
</div>
<div id="code-r-et-réponses-6" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Code R et réponses<a href="régression-pour-données-de-compte-et-dincidence.html#code-r-et-réponses-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour les questions 1 à 3 du TP utilisez le fichier <em>fec.csv</em> (voir description VER p.811).</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous importons la base de données</span></span>
<span id="cb323-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-2" aria-hidden="true" tabindex="-1"></a>fec <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;fec.csv&quot;</span>, </span>
<span id="cb323-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb323-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb323-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-6" aria-hidden="true" tabindex="-1"></a><span class="co">#On recode certaines variables</span></span>
<span id="cb323-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-7" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>fec<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(fec<span class="sc">$</span>fec)</span>
<span id="cb323-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-8" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>lact)</span>
<span id="cb323-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-9" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>past_lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>past_lact)</span>
<span id="cb323-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-10" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>man_heif<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>man_heif)</span>
<span id="cb323-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-11" aria-hidden="true" tabindex="-1"></a>fec<span class="sc">$</span>man_lact<span class="ot">&lt;-</span><span class="fu">as.factor</span>(fec<span class="sc">$</span>man_lact)</span>
<span id="cb323-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualisons la base de données</span></span>
<span id="cb323-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb323-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fec)</span></code></pre></div>
<pre><code>##   province herd cow visit tx fec lact season past_lact man_heif man_lact
## 1        1    1  46     5  0   3    1      2         1        0        0
## 2        1    1  46     6  0   3    1      2         1        0        0
## 3        1    1  46     7  0  11    1      2         1        0        0
## 4        1    1  46     8  0   7    1      3         1        0        0
## 5        1    1  46     9  0  17    1      3         1        0        0
## 6        1    1  46    10  0   6    1      3         1        0        0</code></pre>
<p>Dans cette étude nous souhaitons décrire les facteurs de risque associés au compte d’oeufs de parasites dans les fèces de bovins laitier. La variable <em>fec</em> représente le nombre d’oeufs/5g de fèces qui pourra être prédit en fonction de différents prédicteurs. Dans cet exemple il n’y a pas de dénominateur à considérer (i.e. une variable offset n’est pas nécessaire; chaque animal a été échantillonné une seule fois).</p>
<ol style="list-style-type: decimal">
<li>D’abord représenter graphiquement la variable <em>fec</em>. S’agit-il d’une distribution typique pour une donnée de compte? Quelle proportion des observations avait un compte de zéro oeuf?</li>
</ol>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution de notre variable dépendante (fec)</span></span>
<span id="cb325-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb325-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fec, </span>
<span id="cb325-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>fec)</span>
<span id="cb325-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-5" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb325-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, </span>
<span id="cb325-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">&quot;grey&quot;</span></span>
<span id="cb325-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-8" aria-hidden="true" tabindex="-1"></a>                   ) <span class="sc">+</span></span>
<span id="cb325-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb325-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Nombre d&#39;oeufs/5g de fèces&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb325-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Nombre de vache&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-279"></span>
<img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-279-1.png" alt="Distribution des comptes d'oeufs/5g de fèces." width="672" />
<p class="caption">
Figure 8.3: Distribution des comptes d’oeufs/5g de fèces.
</p>
</div>
<p><strong>Réponse:</strong> La distribution du compte d’oeufs est « skewed » comme le sont souvent les données de compte et d’incidence. 50% des observations ont un compte de zéro oeuf.</p>
<ol start="2" style="list-style-type: decimal">
<li>Essayez d’abord de modéliser l’effet de <em>tx</em> (un traitement à l’Eprinomectin au vêlage) sur le compte d’oeuf (<em>fec</em>) en prenant en compte les facteurs confondants <em>lact</em>, <em>man_heif</em> et <em>man_lact</em> à l’aide d’une régression binomiale négative.</li>
</ol>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le modèle BN  </span></span>
<span id="cb326-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb326-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-3" aria-hidden="true" tabindex="-1"></a>modele_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>fec, </span>
<span id="cb326-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-4" aria-hidden="true" tabindex="-1"></a>                    fec <span class="sc">~</span> tx <span class="sc">+</span> lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact</span>
<span id="cb326-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-5" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb326-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_nb)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = fec ~ tx + lact + man_heif + man_lact, data = fec, 
##     init.theta = 0.2034616714, link = log)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5454  -1.1257  -0.8016  -0.1563   5.0501  
## 
## Coefficients:
##             Estimate Std. Error z value       Pr(&gt;|z|)    
## (Intercept)  2.58438    0.08977  28.789        &lt; 2e-16 ***
## tx          -0.85893    0.13467  -6.378 0.000000000179 ***
## lact1       -1.10775    0.10696 -10.356        &lt; 2e-16 ***
## man_heif1   -1.26782    0.13150  -9.641        &lt; 2e-16 ***
## man_lact1    1.68948    0.13427  12.583        &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(0.2035) family taken to be 1)
## 
##     Null deviance: 2361.7  on 2249  degrees of freedom
## Residual deviance: 2020.3  on 2245  degrees of freedom
## AIC: 10560
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  0.20346 
##           Std. Err.:  0.00755 
## 
##  2 x log-likelihood:  -10548.11100</code></pre>
<p>2.1. D’abord, est-ce que le paramètre de dispersion (i.e. le Theta) est statistiquement différent de zéro? Qu’est-ce que cela vous indique?</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Un modèle Poisson</span></span>
<span id="cb328-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-2" aria-hidden="true" tabindex="-1"></a>modele_p <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>fec,</span>
<span id="cb328-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-3" aria-hidden="true" tabindex="-1"></a>                fec <span class="sc">~</span> tx <span class="sc">+</span> lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact, </span>
<span id="cb328-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">&quot;poisson&quot;</span></span>
<span id="cb328-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-5" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb328-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Test de rapport de vraisemblance</span></span>
<span id="cb328-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb328-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(modele_p, </span>
<span id="cb328-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb328-10" aria-hidden="true" tabindex="-1"></a>       modele_nb)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: fec ~ tx + lact + man_heif + man_lact
## Model 2: fec ~ tx + lact + man_heif + man_lact
##   #Df   LogLik Df Chisq Pr(&gt;Chisq)    
## 1   5 -30918.0                        
## 2   6  -5274.1  1 51288  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Réponse:</strong> Oui le paramètre de dispersion est statistiquement différent de zéro puisque son IC 95% (0.203 +/- 1.96*0.008) n’inclus pas la valeur zéro. Un test de rapport de vraisemblance comparant des modèles Poisson et Binomial négatif arrive aux mêmes conclusions (P &lt; 0.001). Cela indique que le modèle de régression Binomial négatif est préférable au modèle de Poisson (i.e. la variance n’égale pas la moyenne pour au moins un profil de prédicteurs).</p>
<p>2.2. Est-ce que le modèle est adéquat pour vos données?</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb330-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Permet de générer des résiduels par simulation</span></span>
<span id="cb330-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-3" aria-hidden="true" tabindex="-1"></a>negbin_simulation <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> modele_nb)</span>
<span id="cb330-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Permet de visualiser les résiduels vs les valeurs prédites.</span></span>
<span id="cb330-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotSimulatedResiduals</span>(<span class="at">simulationOutput =</span> negbin_simulation)</span></code></pre></div>
<p><img src="Labo-R-Bookdown-project_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Permet de tester avec le Pearson chi-square test s&#39;il y a surdispersion </span></span>
<span id="cb331-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(negbin_simulation, </span>
<span id="cb331-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb331-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type=</span><span class="st">&quot;PearsonChisq&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Parametric dispersion test via mean Pearson-chisq statistic
## 
## data:  negbin_simulation
## dispersion = 2.21, df = 2245, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided</code></pre>
<p><strong>Réponse:</strong> Le test de <span class="math inline">\(chi^2\)</span> de Pearson indique que le modèle n’est pas adéquat pour les données (P &lt; 0.05). Donc le modèle ne semble pas adéquat. Sur la figure, il semble y avoir 6 profils de prédicteurs problématiques (sur 12 profils potentiels).</p>
<p>2.3. Vérifiez si un modèle zéros-enflé Binomial négatif (ZINB) serait préférable à un modèle Binomial négatif.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb333-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-2" aria-hidden="true" tabindex="-1"></a>modele_zinb <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(<span class="at">data=</span>fec,</span>
<span id="cb333-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-3" aria-hidden="true" tabindex="-1"></a>                        fec <span class="sc">~</span> tx <span class="sc">+</span> lact <span class="sc">+</span> man_heif <span class="sc">+</span> man_lact, </span>
<span id="cb333-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dist=</span><span class="st">&quot;negbin&quot;</span></span>
<span id="cb333-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-5" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb333-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(modele_nb, </span>
<span id="cb333-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb333-7" aria-hidden="true" tabindex="-1"></a>      modele_zinb)</span></code></pre></div>
<pre><code>## Vuong Non-Nested Hypothesis Test-Statistic: 
## (test-statistic is asymptotically distributed N(0,1) under the
##  null that the models are indistinguishible)
## -------------------------------------------------------------
##               Vuong z-statistic             H_A   p-value
## Raw                   -2.524802 model2 &gt; model1 0.0057882
## AIC-corrected         -1.698782 model2 &gt; model1 0.0446801
## BIC-corrected          0.663091 model1 &gt; model2 0.2536362</code></pre>
<p><strong>Réponse:</strong> En appliquant le test de Vuong, on note que 2 des 3 tests statistiques réalisés suggèrent que le modèle ZINB est supérieur au NB.</p>
<p>2.4. À l’aide de ce dernier modèle, expliquez l’effet du traitement à l’Eprinomectin sur le compte d’oeufs de parasite.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ayayaye! ;-)</span></span>
<span id="cb335-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="co"># LA PARTIE LOGISTIQUE</span></span>
<span id="cb335-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les coefficients et les erreurs types de la partie logistique (binomiale) du modèle dans une même table</span></span>
<span id="cb335-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-5" aria-hidden="true" tabindex="-1"></a>coefs_logi <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(modele_zinb)<span class="sc">$</span>coefficients<span class="sc">$</span>zero[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb335-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coefs_logi)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">&quot;SE&quot;</span></span>
<span id="cb335-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les IC95</span></span>
<span id="cb335-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-8" aria-hidden="true" tabindex="-1"></a>coefs_logi<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> coefs_logi<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>coefs_logi<span class="sc">$</span>SE</span>
<span id="cb335-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-9" aria-hidden="true" tabindex="-1"></a>coefs_logi<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> coefs_logi<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>coefs_logi<span class="sc">$</span>SE</span>
<span id="cb335-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Ici on pourrait déjà renverser tous les coefficients et les CI</span></span>
<span id="cb335-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre à l&#39;exposant les coefficients</span></span>
<span id="cb335-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-13" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs_logi)</span>
<span id="cb335-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer l&#39;intercept (la 1ère rangée) et les erreurs-types</span></span>
<span id="cb335-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-15" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> OR[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb335-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-16" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">subset</span>(OR, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(SE))</span>
<span id="cb335-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-19" aria-hidden="true" tabindex="-1"></a><span class="co"># LA PARTIE COMPTE</span></span>
<span id="cb335-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les coefficients et les erreurs types de la partie Binomiale négative du modèle dans une même table</span></span>
<span id="cb335-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-21" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(modele_zinb)<span class="sc">$</span>coefficients<span class="sc">$</span>count[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb335-22"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coefs)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">&quot;SE&quot;</span></span>
<span id="cb335-23"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les IC95</span></span>
<span id="cb335-24"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-24" aria-hidden="true" tabindex="-1"></a>coefs<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> coefs<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>coefs<span class="sc">$</span>SE</span>
<span id="cb335-25"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-25" aria-hidden="true" tabindex="-1"></a>coefs<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> coefs<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>coefs<span class="sc">$</span>SE</span>
<span id="cb335-26"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre à l&#39;exposant les coefficients</span></span>
<span id="cb335-27"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-27" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs)</span>
<span id="cb335-28"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer l&#39;intercept (la 1ère rangée), le paramètre de dispersion (la 6ième rangée) et les erreurs-types</span></span>
<span id="cb335-29"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-29" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> IR[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), ]</span>
<span id="cb335-30"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-30" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> <span class="fu">subset</span>(IR, </span>
<span id="cb335-31"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(SE)</span>
<span id="cb335-32"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-32" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb335-33"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-34"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-35"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalement, on pourra demander à voir ces tables</span></span>
<span id="cb335-36"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb335-37"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb335-38"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(OR, </span>
<span id="cb335-39"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb335-40"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;Partie logistique du modèle zéro-enflé Binomial négatif (ZINB).&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb335-41"><a href="régression-pour-données-de-compte-et-dincidence.html#cb335-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-284">Table 8.6: </span>Partie logistique du modèle zéro-enflé Binomial négatif (ZINB).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
tx
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
2.590000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
lact1
</td>
<td style="text-align:right;">
1.93
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
3.790000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
man_heif1
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
3.200000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
man_lact1
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2.116468e+153
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(IR, </span>
<span id="cb336-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb336-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb336-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb336-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;Partie binomiale négative du modèle zéro-enflé Binomial négatif (ZINB).&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb336-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-284">Table 8.6: </span>Partie binomiale négative du modèle zéro-enflé Binomial négatif (ZINB).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
tx
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.58
</td>
</tr>
<tr>
<td style="text-align:left;">
lact1
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
man_heif1
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
Log(theta)
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
</tbody>
</table>
<p><strong>Réponse:</strong> Les vaches traitées à l’Eprinomectin au vêlage avaient 1.24 (IC 95% : 0.60, 2.59) fois les odds de ne pas avoir d’oeufs de parasites dans leur fèces comparativement aux vaches non traitées et elles avaient 0.44 (IC 95% : 0.33, 0.58) fois le nombre d’oeufs de parasites des vaches non-traitées.</p>
<p>Pour la question 3 du TP utilisez le fichier <em>daisy2.csv</em> (voir description VER p.809).</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb337-1" aria-hidden="true" tabindex="-1"></a>daisy2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;daisy2.csv&quot;</span>, </span>
<span id="cb337-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb337-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb337-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb337-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>Ne sélectionnez que les 7 troupeaux avec <em>H7</em>=1 et n’utilisez que la 1ère lactation observée sur chaque vache (<em>study_lact</em>=1).</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb338-1" aria-hidden="true" tabindex="-1"></a>daisy2_mod<span class="ot">&lt;-</span><span class="fu">subset</span>(daisy2, h7<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb338-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb338-2" aria-hidden="true" tabindex="-1"></a>daisy2_mod<span class="ot">&lt;-</span><span class="fu">subset</span>(daisy2_mod, </span>
<span id="cb338-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb338-3" aria-hidden="true" tabindex="-1"></a>                   study_lact<span class="sc">==</span><span class="dv">1</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Dans cette étude on se demande si une rétention placentaire (<em>rp</em>) affecte la probabilité de conception à la première saillie (<em>fs</em>) après avoir contrôlé pour l’âge de la vache (<em>parity</em>). Les chercheurs désirent calculer la fraction attribuable dans la population (<em>AFp</em>).</li>
</ol>
<p><span class="math inline">\(AF_p = (P(E+)(RR-1))/(P(E+)(RR-1)+1))\)</span></p>
<p>3.1. Dans ce cas, est-ce que ce serait correct de remplacer le risque relatif dans l’équation précédente par un rapport de cotes estimé à l’aide d’un modèle de régression logistique?</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb339-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(daisy2_mod<span class="sc">$</span>fs), </span>
<span id="cb339-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb339-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&#39;render&#39;</span>)</span></code></pre></div>
<div class="container st-container">
<h3>Data Frame Summary</h3>
<h4>daisy2_mod</h4>
<strong>Dimensions</strong>: 1795 x 1
  <br/><strong>Duplicates</strong>: 1792
<br/>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>No</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Valid</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">daisy2_mod
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Min  : 0</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean : 0.5</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Max  : 1</td></tr></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">0</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">714</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">49.9%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">1</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">718</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">50.1%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAFgAAAA3BAMAAAB6GZCIAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5wETFgAl6/Zb3gAAADxJREFUSMdjYBiaQIkYoAhVrGxMBBhVPKp4VDHNFJOUYQWJAjRXTJSblUgJDaNRxaOKRxXTSjFJGXaoAQAQVUakLiPLPQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMS0xOVQyMjowMDozNyswMDowMHLBxvwAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDEtMTlUMjI6MDA6MzcrMDA6MDADnH5AAAAAAElFTkSuQmCC"></td>
      <td align="center">1432
(79.8%)</td>
      <td align="center">363
(20.2%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 1.0.1 (<a href='https://www.r-project.org/'>R</a> version 4.2.0)<br/>2023-01-19</p>
</div>
<p><strong>Réponse:</strong> 50% des observations ont <em>fs</em>=1. Il ne s’agit donc pas d’un événement rare (i.e. &lt; 5%). Ce ne serait pas approprié d’utiliser une supposition qui n’est valide que si la maladie est rare.</p>
<p>3.2. Quel serait le risque relatif de conception à la 1ère saillie et son IC 95% lorsque rétention placentaire est présent <em>vs.</em> absent et après ajustement pour l’âge de la vache?</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-1" aria-hidden="true" tabindex="-1"></a>modele_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>daisy2_mod,</span>
<span id="cb340-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-2" aria-hidden="true" tabindex="-1"></a>                      fs <span class="sc">~</span> rp <span class="sc">+</span> parity, </span>
<span id="cb340-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb340-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co">#On demande la variance robuste</span></span>
<span id="cb340-6"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb340-7"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-7" aria-hidden="true" tabindex="-1"></a>rob_SE <span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(modele_poisson)))</span>
<span id="cb340-8"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-9"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Pour faciliter la lecture, nous pourrions ajouter les erreurs-types robustes à mes coefficients dans une table</span></span>
<span id="cb340-10"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-10" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">Estimate=</span>modele_poisson<span class="sc">$</span>coefficients, </span>
<span id="cb340-11"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">robust_SE=</span>rob_SE)</span>
<span id="cb340-12"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-12" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb340-13"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-14"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Puis calculer les IC95</span></span>
<span id="cb340-15"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-15" aria-hidden="true" tabindex="-1"></a>tab_SE<span class="sc">$</span>lower.ci <span class="ot">&lt;-</span> tab_SE<span class="sc">$</span>Estimate<span class="fl">-1.96</span><span class="sc">*</span>tab_SE<span class="sc">$</span>robust_SE</span>
<span id="cb340-16"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-16" aria-hidden="true" tabindex="-1"></a>tab_SE<span class="sc">$</span>upper.ci <span class="ot">&lt;-</span> tab_SE<span class="sc">$</span>Estimate<span class="fl">+1.96</span><span class="sc">*</span>tab_SE<span class="sc">$</span>robust_SE</span>
<span id="cb340-17"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-18"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Enlever l&#39;intercept, les SE et mettre tout à l&#39;exposant pour avoir des RR </span></span>
<span id="cb340-19"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-19" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> tab_SE[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb340-20"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-20" aria-hidden="true" tabindex="-1"></a>tab_SE <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">subset</span>(tab_SE, </span>
<span id="cb340-21"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(robust_SE)</span>
<span id="cb340-22"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-22" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb340-23"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-23" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb340-24"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-25"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb340-26"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb340-27"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(tab_SE, </span>
<span id="cb340-28"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb340-29"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span><span class="st">&quot;Modèle de Poisson avec erreurs-types robustes pour estimer le risque relatif de conception à la 1ère saillie.&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb340-30"><a href="régression-pour-données-de-compte-et-dincidence.html#cb340-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-288">Table 8.7: </span>Modèle de Poisson avec erreurs-types robustes pour estimer le risque relatif de conception à la 1ère saillie.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
lower.ci
</th>
<th style="text-align:right;">
upper.ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rp
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
1.09
</td>
</tr>
<tr>
<td style="text-align:left;">
parity
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
</tbody>
</table>
<p><strong>Réponse:</strong> Le risque de conception à la première saillie pour une vache qui a eu une rétention placentaire était 0.91 fois (IC 95% : 0.75, 1.09) celui d’une vache qui n’a pas eu de rétention placentaire. Ce n’est pas statistiquement significatif cependant.</p>
<p>3.3. Quelle serait la fraction attribuable (<em>AFp</em>) dans la population due aux rétentions placentaires? Comment interprétez-vous ce résultat?</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Vérifier prévalence de l&#39;exposition (rp)</span></span>
<span id="cb341-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb341-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(daisy2_mod<span class="sc">$</span>rp), </span>
<span id="cb341-4"><a href="régression-pour-données-de-compte-et-dincidence.html#cb341-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&#39;render&#39;</span>)</span></code></pre></div>
<div class="container st-container">
<h3>Data Frame Summary</h3>
<h4>daisy2_mod</h4>
<strong>Dimensions</strong>: 1795 x 1
  <br/><strong>Duplicates</strong>: 1793
<br/>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>No</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Valid</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">daisy2_mod
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Min  : 0</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean : 0.1</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Max  : 1</td></tr></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">0</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">1613</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">89.9%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">1</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">182</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">10.1%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAJMAAAA3BAMAAAD6RmXeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5wETFgAl6/Zb3gAAAExJREFUWMNjYBgFpAAlyoEC1ChlY4rBqFGjRo0aNWrUqFGDzCgqVhOClAOBQW0UzMNUMAoag0ajRo0aNWrUqFGjRg0fo6hYTYwC4gAAaf6kF5r7ubwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDEtMTlUMjI6MDA6MzcrMDA6MDBywcb8AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAxLTE5VDIyOjAwOjM3KzAwOjAwA5x+QAAAAABJRU5ErkJggg=="></td>
      <td align="center">1795
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 1.0.1 (<a href='https://www.r-project.org/'>R</a> version 4.2.0)<br/>2023-01-19</p>
</div>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="régression-pour-données-de-compte-et-dincidence.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculer l&#39;AFp</span></span>
<span id="cb342-2"><a href="régression-pour-données-de-compte-et-dincidence.html#cb342-2" aria-hidden="true" tabindex="-1"></a>afp <span class="ot">&lt;-</span> <span class="fl">0.101</span><span class="sc">*</span>(<span class="fl">0.91</span><span class="dv">-1</span>)<span class="sc">/</span>(<span class="fl">0.101</span><span class="sc">*</span>(<span class="fl">0.91</span><span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb342-3"><a href="régression-pour-données-de-compte-et-dincidence.html#cb342-3" aria-hidden="true" tabindex="-1"></a>afp</span></code></pre></div>
<pre><code>## [1] -0.009173386</code></pre>
<p><strong>Réponse:</strong> En supposant que la relation est causale, une réduction de 1% (i.e., -0.009) de la conception à la 1ère saillie serait due aux rétentions placentaires.</p>
<p>3.4. Question bonus (i.e. vous aurez 2 banana-points supplémentaires si vous répondez correctement): Comment pourriez-vous obtenir un IC 95% pour l’<em>AFp</em>?</p>
<p><strong>Réponse:</strong> À l’aide du Bootstrap, on pourrait recréer un grand nombre de jeux de données et estimer le risque relatif et la prévalence de rétention placentaire dans chaque jeu de données. Ensuite, on calcule l’<em>AFp</em> de chaque jeu de données et on rapporte le percentile 2.5 et 97.5 de l’<em>AFp</em> comme IC 95%.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC521200/pdf/1471-2288-3-21.pdf">Barros, A. J. D. and V. N. Hirakata. 2003. Alternatives for logistic regression in cross-sectional studies: an empirical comparison of models that directly estimate the prevalence ratio. BMC Med Res Methodol.</a><a href="régression-pour-données-de-compte-et-dincidence.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="régression-logistique.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyses-de-survie.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Labo R Bookdown project.pdf", "Labo R Bookdown project.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
